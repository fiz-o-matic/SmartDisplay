<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Interactive BOM for KiCAD</title>
  <style type="text/css">
:root {
  --pcb-edge-color: black;
  --pad-color: #878787;
  --pad-hole-color: #CCCCCC;
  --pad-color-highlight: #D04040;
  --pad-color-highlight-both: #D0D040;
  --pad-color-highlight-marked: #44a344;
  --pin1-outline-color: #ffb629;
  --pin1-outline-color-highlight: #ffb629;
  --pin1-outline-color-highlight-both: #fcbb39;
  --pin1-outline-color-highlight-marked: #fdbe41;
  --silkscreen-edge-color: #aa4;
  --silkscreen-polygon-color: #4aa;
  --silkscreen-text-color: #4aa;
  --fabrication-edge-color: #907651;
  --fabrication-polygon-color: #907651;
  --fabrication-text-color: #a27c24;
  --track-color: #def5f1;
  --track-color-highlight: #D04040;
  --zone-color: #def5f1;
  --zone-color-highlight: #d0404080;
}

html,
body {
  margin: 0px;
  height: 100%;
  font-family: Verdana, sans-serif;
}

.dark.topmostdiv {
  --pcb-edge-color: #eee;
  --pad-color: #808080;
  --pin1-outline-color: #ffa800;
  --pin1-outline-color-highlight: #ccff00;
  --track-color: #42524f;
  --zone-color: #42524f;
  background-color: #252c30;
  color: #eee;
}

button {
  background-color: #eee;
  border: 1px solid #888;
  color: black;
  height: 44px;
  width: 44px;
  text-align: center;
  text-decoration: none;
  display: inline-block;
  font-size: 14px;
  font-weight: bolder;
}

.dark button {
  /* This will be inverted */
  background-color: #c3b7b5;
}

button.depressed {
  background-color: #0a0;
  color: white;
}

.dark button.depressed {
  /* This will be inverted */
  background-color: #b3b;
}

button:focus {
  outline: 0;
}

button#tb-btn {
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 8.47 8.47'%3E%3Crect transform='translate(0 -288.53)' ry='1.17' y='288.8' x='.27' height='7.94' width='7.94' fill='%23f9f9f9'/%3E%3Cg transform='translate(0 -288.53)'%3E%3Crect width='7.94' height='7.94' x='.27' y='288.8' ry='1.17' fill='none' stroke='%23000' stroke-width='.4' stroke-linejoin='round'/%3E%3Cpath d='M1.32 290.12h5.82M1.32 291.45h5.82' fill='none' stroke='%23000' stroke-width='.4'/%3E%3Cpath d='M4.37 292.5v4.23M.26 292.63H8.2' fill='none' stroke='%23000' stroke-width='.3'/%3E%3Ctext font-weight='700' font-size='3.17' font-family='sans-serif'%3E%3Ctspan x='1.35' y='295.73'%3EF%3C/tspan%3E%3Ctspan x='5.03' y='295.68'%3EB%3C/tspan%3E%3C/text%3E%3C/g%3E%3C/svg%3E%0A");
}

button#lr-btn {
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 8.47 8.47'%3E%3Crect transform='translate(0 -288.53)' ry='1.17' y='288.8' x='.27' height='7.94' width='7.94' fill='%23f9f9f9'/%3E%3Cg transform='translate(0 -288.53)'%3E%3Crect width='7.94' height='7.94' x='.27' y='288.8' ry='1.17' fill='none' stroke='%23000' stroke-width='.4' stroke-linejoin='round'/%3E%3Cpath d='M1.06 290.12H3.7m-2.64 1.33H3.7m-2.64 1.32H3.7m-2.64 1.3H3.7m-2.64 1.33H3.7' fill='none' stroke='%23000' stroke-width='.4'/%3E%3Cpath d='M4.37 288.8v7.94m0-4.11h3.96' fill='none' stroke='%23000' stroke-width='.3'/%3E%3Ctext font-weight='700' font-size='3.17' font-family='sans-serif'%3E%3Ctspan x='5.11' y='291.96'%3EF%3C/tspan%3E%3Ctspan x='5.03' y='295.68'%3EB%3C/tspan%3E%3C/text%3E%3C/g%3E%3C/svg%3E%0A");
}

button#bom-btn {
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 8.47 8.47'%3E%3Crect transform='translate(0 -288.53)' ry='1.17' y='288.8' x='.27' height='7.94' width='7.94' fill='%23f9f9f9'/%3E%3Cg transform='translate(0 -288.53)' fill='none' stroke='%23000' stroke-width='.4'%3E%3Crect width='7.94' height='7.94' x='.27' y='288.8' ry='1.17' stroke-linejoin='round'/%3E%3Cpath d='M1.59 290.12h5.29M1.59 291.45h5.33M1.59 292.75h5.33M1.59 294.09h5.33M1.59 295.41h5.33'/%3E%3C/g%3E%3C/svg%3E");
}

button#bom-grouped-btn {
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='32' height='32'%3E%3Cg stroke='%23000' stroke-linejoin='round' class='layer'%3E%3Crect width='29' height='29' x='1.5' y='1.5' stroke-width='2' fill='%23fff' rx='5' ry='5'/%3E%3Cpath stroke-linecap='square' stroke-width='2' d='M6 10h4m4 0h5m4 0h3M6.1 22h3m3.9 0h5m4 0h4m-16-8h4m4 0h4'/%3E%3Cpath stroke-linecap='null' d='M5 17.5h22M5 26.6h22M5 5.5h22'/%3E%3C/g%3E%3C/svg%3E");
}

button#bom-ungrouped-btn {
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='32' height='32'%3E%3Cg stroke='%23000' stroke-linejoin='round' class='layer'%3E%3Crect width='29' height='29' x='1.5' y='1.5' stroke-width='2' fill='%23fff' rx='5' ry='5'/%3E%3Cpath stroke-linecap='square' stroke-width='2' d='M6 10h4m-4 8h3m-3 8h4'/%3E%3Cpath stroke-linecap='null' d='M5 13.5h22m-22 8h22M5 5.5h22'/%3E%3C/g%3E%3C/svg%3E");
}

button#bom-netlist-btn {
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='32' height='32'%3E%3Cg fill='none' stroke='%23000' class='layer'%3E%3Crect width='29' height='29' x='1.5' y='1.5' stroke-width='2' fill='%23fff' rx='5' ry='5'/%3E%3Cpath stroke-width='2' d='M6 26l6-6v-8m13.8-6.3l-6 6v8'/%3E%3Ccircle cx='11.8' cy='9.5' r='2.8' stroke-width='2'/%3E%3Ccircle cx='19.8' cy='22.8' r='2.8' stroke-width='2'/%3E%3C/g%3E%3C/svg%3E");
}

button#copy {
  background-image: url("data:image/svg+xml,%3Csvg height='48' viewBox='0 0 48 48' width='48' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M0 0h48v48h-48z' fill='none'/%3E%3Cpath d='M32 2h-24c-2.21 0-4 1.79-4 4v28h4v-28h24v-4zm6 8h-22c-2.21 0-4 1.79-4 4v28c0 2.21 1.79 4 4 4h22c2.21 0 4-1.79 4-4v-28c0-2.21-1.79-4-4-4zm0 32h-22v-28h22v28z'/%3E%3C/svg%3E");
  background-position: 6px 6px;
  background-repeat: no-repeat;
  background-size: 26px 26px;
  border-radius: 6px;
  height: 40px;
  width: 40px;
  margin: 10px 5px;
}

button#copy:active {
  box-shadow: inset 0px 0px 5px #6c6c6c;
}

textarea.clipboard-temp {
  position: fixed;
  top: 0;
  left: 0;
  width: 2em;
  height: 2em;
  padding: 0;
  border: None;
  outline: None;
  box-shadow: None;
  background: transparent;
}

.left-most-button {
  border-right: 0;
  border-top-left-radius: 6px;
  border-bottom-left-radius: 6px;
}

.middle-button {
  border-right: 0;
}

.right-most-button {
  border-top-right-radius: 6px;
  border-bottom-right-radius: 6px;
}

.button-container {
  font-size: 0;
  margin: 0.4rem 0.4rem 0.4rem 0;
}

.dark .button-container {
  filter: invert(1);
}

.button-container button {
  background-size: 32px 32px;
  background-position: 5px 5px;
  background-repeat: no-repeat;
}

@media print {
  .hideonprint {
    display: none;
  }
}

canvas {
  cursor: crosshair;
}

canvas:active {
  cursor: grabbing;
}

.fileinfo {
  width: 100%;
  max-width: 1000px;
  border: none;
  padding: 3px;
}

.fileinfo .title {
  font-size: 20pt;
  font-weight: bold;
}

.fileinfo td {
  overflow: hidden;
  white-space: nowrap;
  max-width: 1px;
  width: 50%;
  text-overflow: ellipsis;
}

.bom {
  border-collapse: collapse;
  font-family: Consolas, "DejaVu Sans Mono", Monaco, monospace;
  font-size: 10pt;
  table-layout: fixed;
  width: 100%;
  margin-top: 1px;
  position: relative;
}

.bom th,
.bom td {
  border: 1px solid black;
  padding: 5px;
  word-wrap: break-word;
  text-align: center;
  position: relative;
}

.dark .bom th,
.dark .bom td {
  border: 1px solid #777;
}

.bom th {
  background-color: #CCCCCC;
  background-clip: padding-box;
}

.dark .bom th {
  background-color: #3b4749;
}

.bom tr.highlighted:nth-child(n) {
  background-color: #cfc;
}

.dark .bom tr.highlighted:nth-child(n) {
  background-color: #226022;
}

.bom tr:nth-child(even) {
  background-color: #f2f2f2;
}

.dark .bom tr:nth-child(even) {
  background-color: #313b40;
}

.bom tr.checked {
  color: #1cb53d;
}

.dark .bom tr.checked {
  color: #2cce54;
}

.bom tr {
  transition: background-color 0.2s;
}

.bom .numCol {
  width: 30px;
}

.bom .value {
  width: 15%;
}

.bom .quantity {
  width: 65px;
}

.bom th .sortmark {
  position: absolute;
  right: 1px;
  top: 1px;
  margin-top: -5px;
  border-width: 5px;
  border-style: solid;
  border-color: transparent transparent #221 transparent;
  transform-origin: 50% 85%;
  transition: opacity 0.2s, transform 0.4s;
}

.dark .bom th .sortmark {
  filter: invert(1);
}

.bom th .sortmark.none {
  opacity: 0;
}

.bom th .sortmark.desc {
  transform: rotate(180deg);
}

.bom th:hover .sortmark.none {
  opacity: 0.5;
}

.bom .bom-checkbox {
  width: 30px;
  position: relative;
  user-select: none;
  -moz-user-select: none;
}

.bom .bom-checkbox:before {
  content: "";
  position: absolute;
  border-width: 15px;
  border-style: solid;
  border-color: #51829f transparent transparent transparent;
  visibility: hidden;
  top: -15px;
}

.bom .bom-checkbox:after {
  content: "Double click to set/unset all";
  position: absolute;
  color: white;
  top: -35px;
  left: -26px;
  background: #51829f;
  padding: 5px 15px;
  border-radius: 8px;
  white-space: nowrap;
  visibility: hidden;
}

.bom .bom-checkbox:hover:before,
.bom .bom-checkbox:hover:after {
  visibility: visible;
  transition: visibility 0.2s linear 1s;
}

.split {
  -webkit-box-sizing: border-box;
  -moz-box-sizing: border-box;
  box-sizing: border-box;
  overflow-y: auto;
  overflow-x: hidden;
  background-color: inherit;
}

.split.split-horizontal,
.gutter.gutter-horizontal {
  height: 100%;
  float: left;
}

.gutter {
  background-color: #ddd;
  background-repeat: no-repeat;
  background-position: 50%;
  transition: background-color 0.3s;
}

.dark .gutter {
  background-color: #777;
}

.gutter.gutter-horizontal {
  background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAeCAYAAADkftS9AAAAIklEQVQoU2M4c+bMfxAGAgYYmwGrIIiDjrELjpo5aiZeMwF+yNnOs5KSvgAAAABJRU5ErkJggg==');
  cursor: ew-resize;
  width: 5px;
}

.gutter.gutter-vertical {
  background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAFAQMAAABo7865AAAABlBMVEVHcEzMzMzyAv2sAAAAAXRSTlMAQObYZgAAABBJREFUeF5jOAMEEAIEEFwAn3kMwcB6I2AAAAAASUVORK5CYII=');
  cursor: ns-resize;
  height: 5px;
}

.searchbox {
  float: left;
  height: 40px;
  margin: 10px 5px;
  padding: 12px 32px;
  font-family: Consolas, "DejaVu Sans Mono", Monaco, monospace;
  font-size: 18px;
  box-sizing: border-box;
  border: 1px solid #888;
  border-radius: 6px;
  outline: none;
  background-color: #eee;
  transition: background-color 0.2s, border 0.2s;
  background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAABNklEQVQ4T8XSMUvDQBQH8P/LElFa/AIZHcTBQSz0I/gFstTBRR2KUC4ldDxw7h0Bl3RRUATxi4iiODgoiLNrbQYp5J6cpJJqomkX33Z37/14d/dIa33MzDuYI4johOI4XhyNRteO46zNYjDzAxE1yBZprVeZ+QbAUhXEGJMA2Ox2u4+fQIa0mPmsCgCgJYQ4t7lfgF0opQYAdv9ABkKI/UnOFCClXKjX61cA1osQY8x9kiRNKeV7IWA3oyhaSdP0FkAtjxhj3hzH2RBCPOf3pzqYHCilfAAX+URm9oMguPzeWSGQvUcMYC8rOBJCHBRdqxTo9/vbRHRqi8bj8XKv1xvODbiuW2u32/bvf0SlDv4XYOY7z/Mavu+nM1+BmQ+NMc0wDF/LprP0DbTWW0T00ul0nn4b7Q87+X4Qmfiq2wAAAABJRU5ErkJggg==');
  background-position: 10px 10px;
  background-repeat: no-repeat;
}

.dark .searchbox {
  background-color: #111;
  color: #eee;
}

.searchbox::placeholder {
  color: #ccc;
}

.dark .searchbox::placeholder {
  color: #666;
}

.filter {
  width: calc(60% - 64px);
}

.reflookup {
  width: calc(40% - 10px);
}

input[type=text]:focus {
  background-color: white;
  border: 1px solid #333;
}

.dark input[type=text]:focus {
  background-color: #333;
  border: 1px solid #ccc;
}

mark.highlight {
  background-color: #5050ff;
  color: #fff;
  padding: 2px;
  border-radius: 6px;
}

.dark mark.highlight {
  background-color: #76a6da;
  color: #111;
}

.menubtn {
  background-color: white;
  border: none;
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='36' height='36' viewBox='0 0 20 20'%3E%3Cpath fill='none' d='M0 0h20v20H0V0z'/%3E%3Cpath d='M15.95 10.78c.03-.25.05-.51.05-.78s-.02-.53-.06-.78l1.69-1.32c.15-.12.19-.34.1-.51l-1.6-2.77c-.1-.18-.31-.24-.49-.18l-1.99.8c-.42-.32-.86-.58-1.35-.78L12 2.34c-.03-.2-.2-.34-.4-.34H8.4c-.2 0-.36.14-.39.34l-.3 2.12c-.49.2-.94.47-1.35.78l-1.99-.8c-.18-.07-.39 0-.49.18l-1.6 2.77c-.1.18-.06.39.1.51l1.69 1.32c-.04.25-.07.52-.07.78s.02.53.06.78L2.37 12.1c-.15.12-.19.34-.1.51l1.6 2.77c.1.18.31.24.49.18l1.99-.8c.42.32.86.58 1.35.78l.3 2.12c.04.2.2.34.4.34h3.2c.2 0 .37-.14.39-.34l.3-2.12c.49-.2.94-.47 1.35-.78l1.99.8c.18.07.39 0 .49-.18l1.6-2.77c.1-.18.06-.39-.1-.51l-1.67-1.32zM10 13c-1.65 0-3-1.35-3-3s1.35-3 3-3 3 1.35 3 3-1.35 3-3 3z'/%3E%3C/svg%3E%0A");
  background-position: center;
  background-repeat: no-repeat;
}

.statsbtn {
  background-color: white;
  border: none;
  background-image: url("data:image/svg+xml,%3Csvg width='36' height='36' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M4 6h28v24H4V6zm0 8h28v8H4m9-16v24h10V5.8' fill='none' stroke='%23000' stroke-width='2'/%3E%3C/svg%3E");
  background-position: center;
  background-repeat: no-repeat;
}

.iobtn {
  background-color: white;
  border: none;
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='36' height='36'%3E%3Cpath fill='none' stroke='%23000' stroke-width='2' d='M3 33v-7l6.8-7h16.5l6.7 7v7H3zM3.2 26H33M21 9l5-5.9 5 6h-2.5V15h-5V9H21zm-4.9 0l-5 6-5-6h2.5V3h5v6h2.5z'/%3E%3Cpath fill='none' stroke='%23000' d='M6.1 29.5H10'/%3E%3C/svg%3E");
  background-position: center;
  background-repeat: no-repeat;
}

.visbtn {
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24'%3E%3Cpath fill='none' stroke='%23333' d='M2.5 4.5h5v15h-5zM9.5 4.5h5v15h-5zM16.5 4.5h5v15h-5z'/%3E%3C/svg%3E");
  background-position: center;
  background-repeat: no-repeat;
  padding: 15px;
}

#vismenu-content {
  left: 0px;
  font-family: Verdana, sans-serif;
}

.dark .statsbtn,
.dark .savebtn,
.dark .menubtn,
.dark .iobtn,
.dark .visbtn {
  filter: invert(1);
}

.flexbox {
  display: flex;
  align-items: center;
  justify-content: space-between;
  width: 100%;
}

.savebtn {
  background-color: #d6d6d6;
  width: auto;
  height: 30px;
  flex-grow: 1;
  margin: 5px;
  border-radius: 4px;
}

.savebtn:active {
  background-color: #0a0;
  color: white;
}

.dark .savebtn:active {
  /* This will be inverted */
  background-color: #b3b;
}

.stats {
  border-collapse: collapse;
  font-size: 12pt;
  table-layout: fixed;
  width: 100%;
  min-width: 450px;
}

.dark .stats td {
  border: 1px solid #bbb;
}

.stats td {
  border: 1px solid black;
  padding: 5px;
  word-wrap: break-word;
  text-align: center;
  position: relative;
}

#checkbox-stats div {
  position: absolute;
  left: 0;
  top: 0;
  height: 100%;
  width: 100%;
  display: flex;
  align-items: center;
  justify-content: center;
}

#checkbox-stats .bar {
  background-color: rgba(28, 251, 0, 0.6);
}

.menu {
  position: relative;
  display: inline-block;
  margin: 0.4rem 0.4rem 0.4rem 0;
}

.menu-content {
  font-size: 12pt !important;
  text-align: left !important;
  font-weight: normal !important;
  display: none;
  position: absolute;
  background-color: white;
  right: 0;
  min-width: 300px;
  box-shadow: 0px 8px 16px 0px rgba(0, 0, 0, 0.2);
  z-index: 100;
  padding: 8px;
}

.dark .menu-content {
  background-color: #111;
}

.menu:hover .menu-content {
  display: block;
}

.menu:hover .menubtn,
.menu:hover .iobtn,
.menu:hover .statsbtn {
  background-color: #eee;
}

.menu-label {
  display: inline-block;
  padding: 8px;
  border: 1px solid #ccc;
  border-top: 0;
  width: calc(100% - 18px);
}

.menu-label-top {
  border-top: 1px solid #ccc;
}

.menu-textbox {
  float: left;
  height: 24px;
  margin: 10px 5px;
  padding: 5px 5px;
  font-family: Consolas, "DejaVu Sans Mono", Monaco, monospace;
  font-size: 14px;
  box-sizing: border-box;
  border: 1px solid #888;
  border-radius: 4px;
  outline: none;
  background-color: #eee;
  transition: background-color 0.2s, border 0.2s;
  width: calc(100% - 10px);
}

.menu-textbox.invalid,
.dark .menu-textbox.invalid {
  color: red;
}

.dark .menu-textbox {
  background-color: #222;
  color: #eee;
}

.radio-container {
  margin: 4px;
}

.topmostdiv {
  display: flex;
  flex-direction: column;
  width: 100%;
  background-color: white;
  transition: background-color 0.3s;
}

#top {
  display: flex;
  flex-wrap: wrap;
  justify-content: flex-end;
  align-items: center;
}

#topdivider {
  border-bottom: 2px solid black;
  display: flex;
  justify-content: center;
  align-items: center;
}

.dark #topdivider {
  border-bottom: 2px solid #ccc;
}

#topdivider>div {
  position: relative;
}

#toptoggle {
  cursor: pointer;
  user-select: none;
  position: absolute;
  padding: 0.1rem 0.3rem;
  top: -0.4rem;
  left: -1rem;
  font-size: 1.4rem;
  line-height: 60%;
  border: 1px solid black;
  border-radius: 1rem;
  background-color: #fff;
  z-index: 100;
}

.flipped {
  transform: rotate(0.5turn);
}

.dark #toptoggle {
  border: 1px solid #fff;
  background-color: #222;
}

#fileinfodiv {
  flex: 20rem 1 0;
  overflow: auto;
}

#bomcontrols {
  display: flex;
  flex-direction: row-reverse;
}

#bomcontrols>* {
  flex-shrink: 0;
}

#dbg {
  display: block;
}

::-webkit-scrollbar {
  width: 8px;
}

::-webkit-scrollbar-track {
  background: #aaa;
}

::-webkit-scrollbar-thumb {
  background: #666;
  border-radius: 3px;
}

::-webkit-scrollbar-thumb:hover {
  background: #555;
}

.slider {
  -webkit-appearance: none;
  width: 100%;
  margin: 3px 0;
  padding: 0;
  outline: none;
  opacity: 0.7;
  -webkit-transition: .2s;
  transition: opacity .2s;
  border-radius: 3px;
}

.slider:hover {
  opacity: 1;
}

.slider:focus {
  outline: none;
}

.slider::-webkit-slider-runnable-track {
  -webkit-appearance: none;
  width: 100%;
  height: 8px;
  background: #d3d3d3;
  border-radius: 3px;
  border: none;
}

.slider::-webkit-slider-thumb {
  -webkit-appearance: none;
  width: 15px;
  height: 15px;
  border-radius: 50%;
  background: #0a0;
  cursor: pointer;
  margin-top: -4px;
}

.dark .slider::-webkit-slider-thumb {
  background: #3d3;
}

.slider::-moz-range-thumb {
  width: 15px;
  height: 15px;
  border-radius: 50%;
  background: #0a0;
  cursor: pointer;
}

.slider::-moz-range-track {
  height: 8px;
  background: #d3d3d3;
  border-radius: 3px;
}

.dark .slider::-moz-range-thumb {
  background: #3d3;
}

.slider::-ms-track {
  width: 100%;
  height: 8px;
  border-width: 3px 0;
  background: transparent;
  border-color: transparent;
  color: transparent;
  transition: opacity .2s;
}

.slider::-ms-fill-lower {
  background: #d3d3d3;
  border: none;
  border-radius: 3px;
}

.slider::-ms-fill-upper {
  background: #d3d3d3;
  border: none;
  border-radius: 3px;
}

.slider::-ms-thumb {
  width: 15px;
  height: 15px;
  border-radius: 50%;
  background: #0a0;
  cursor: pointer;
  margin: 0;
}

.shameless-plug {
  font-size: 0.8em;
  text-align: center;
  display: block;
}

a {
  color: #0278a4;
}

.dark a {
  color: #00b9fd;
}

#frontcanvas,
#backcanvas {
  touch-action: none;
}

.placeholder {
  border: 1px dashed #9f9fda !important;
  background-color: #edf2f7 !important;
}

.dragging {
  z-index: 999;
}

.dark .dragging>table>tbody>tr {
  background-color: #252c30;
}

.dark .placeholder {
  filter: invert(1);
}

.column-spacer {
  top: 0;
  left: 0;
  width: calc(100% - 4px);
  position: absolute;
  cursor: pointer;
  user-select: none;
  height: 100%;
}

.column-width-handle {
  top: 0;
  right: 0;
  width: 4px;
  position: absolute;
  cursor: col-resize;
  user-select: none;
  height: 100%;
}

.column-width-handle:hover {
  background-color: #4f99bd;
}

.help-link {
  border: 1px solid #0278a4;
  padding-inline: 0.3rem;
  border-radius: 3px;
  cursor: pointer;
}

.dark .help-link {
  border: 1px solid #00b9fd;
}

.bom-color {
  width: 20%;
}

.color-column input {
  width: 1.6rem;
  height: 1rem;
  border: 1px solid black;
  cursor: pointer;
  padding: 0;
}

/* removes default styling from input color element */
::-webkit-color-swatch {
  border: none;
}

::-webkit-color-swatch-wrapper {
  padding: 0;
}

::-moz-color-swatch,
::-moz-focus-inner {
  border: none;
}

::-moz-focus-inner {
  padding: 0;
}
/* #bomhead {
    position: sticky;
    top: 0px;
    z-index: 1;
} */
  </style>
  <script type="text/javascript" >
///////////////////////////////////////////////
/*
  Split.js - v1.3.5
  MIT License
  https://github.com/nathancahill/Split.js
*/
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.Split=t()}(this,function(){"use strict";var e=window,t=e.document,n="addEventListener",i="removeEventListener",r="getBoundingClientRect",s=function(){return!1},o=e.attachEvent&&!e[n],a=["","-webkit-","-moz-","-o-"].filter(function(e){var n=t.createElement("div");return n.style.cssText="width:"+e+"calc(9px)",!!n.style.length}).shift()+"calc",l=function(e){return"string"==typeof e||e instanceof String?t.querySelector(e):e};return function(u,c){function z(e,t,n){var i=A(y,t,n);Object.keys(i).forEach(function(t){return e.style[t]=i[t]})}function h(e,t){var n=B(y,t);Object.keys(n).forEach(function(t){return e.style[t]=n[t]})}function f(e){var t=E[this.a],n=E[this.b],i=t.size+n.size;t.size=e/this.size*i,n.size=i-e/this.size*i,z(t.element,t.size,this.aGutterSize),z(n.element,n.size,this.bGutterSize)}function m(e){var t;this.dragging&&((t="touches"in e?e.touches[0][b]-this.start:e[b]-this.start)<=E[this.a].minSize+M+this.aGutterSize?t=E[this.a].minSize+this.aGutterSize:t>=this.size-(E[this.b].minSize+M+this.bGutterSize)&&(t=this.size-(E[this.b].minSize+this.bGutterSize)),f.call(this,t),c.onDrag&&c.onDrag())}function g(){var e=E[this.a].element,t=E[this.b].element;this.size=e[r]()[y]+t[r]()[y]+this.aGutterSize+this.bGutterSize,this.start=e[r]()[G]}function d(){var t=this,n=E[t.a].element,r=E[t.b].element;t.dragging&&c.onDragEnd&&c.onDragEnd(),t.dragging=!1,e[i]("mouseup",t.stop),e[i]("touchend",t.stop),e[i]("touchcancel",t.stop),t.parent[i]("mousemove",t.move),t.parent[i]("touchmove",t.move),delete t.stop,delete t.move,n[i]("selectstart",s),n[i]("dragstart",s),r[i]("selectstart",s),r[i]("dragstart",s),n.style.userSelect="",n.style.webkitUserSelect="",n.style.MozUserSelect="",n.style.pointerEvents="",r.style.userSelect="",r.style.webkitUserSelect="",r.style.MozUserSelect="",r.style.pointerEvents="",t.gutter.style.cursor="",t.parent.style.cursor=""}function S(t){var i=this,r=E[i.a].element,o=E[i.b].element;!i.dragging&&c.onDragStart&&c.onDragStart(),t.preventDefault(),i.dragging=!0,i.move=m.bind(i),i.stop=d.bind(i),e[n]("mouseup",i.stop),e[n]("touchend",i.stop),e[n]("touchcancel",i.stop),i.parent[n]("mousemove",i.move),i.parent[n]("touchmove",i.move),r[n]("selectstart",s),r[n]("dragstart",s),o[n]("selectstart",s),o[n]("dragstart",s),r.style.userSelect="none",r.style.webkitUserSelect="none",r.style.MozUserSelect="none",r.style.pointerEvents="none",o.style.userSelect="none",o.style.webkitUserSelect="none",o.style.MozUserSelect="none",o.style.pointerEvents="none",i.gutter.style.cursor=j,i.parent.style.cursor=j,g.call(i)}function v(e){e.forEach(function(t,n){if(n>0){var i=F[n-1],r=E[i.a],s=E[i.b];r.size=e[n-1],s.size=t,z(r.element,r.size,i.aGutterSize),z(s.element,s.size,i.bGutterSize)}})}function p(){F.forEach(function(e){e.parent.removeChild(e.gutter),E[e.a].element.style[y]="",E[e.b].element.style[y]=""})}void 0===c&&(c={});var y,b,G,E,w=l(u[0]).parentNode,D=e.getComputedStyle(w).flexDirection,U=c.sizes||u.map(function(){return 100/u.length}),k=void 0!==c.minSize?c.minSize:100,x=Array.isArray(k)?k:u.map(function(){return k}),L=void 0!==c.gutterSize?c.gutterSize:10,M=void 0!==c.snapOffset?c.snapOffset:30,O=c.direction||"horizontal",j=c.cursor||("horizontal"===O?"ew-resize":"ns-resize"),C=c.gutter||function(e,n){var i=t.createElement("div");return i.className="gutter gutter-"+n,i},A=c.elementStyle||function(e,t,n){var i={};return"string"==typeof t||t instanceof String?i[e]=t:i[e]=o?t+"%":a+"("+t+"% - "+n+"px)",i},B=c.gutterStyle||function(e,t){return n={},n[e]=t+"px",n;var n};"horizontal"===O?(y="width","clientWidth",b="clientX",G="left","paddingLeft"):"vertical"===O&&(y="height","clientHeight",b="clientY",G="top","paddingTop");var F=[];return E=u.map(function(e,t){var i,s={element:l(e),size:U[t],minSize:x[t]};if(t>0&&(i={a:t-1,b:t,dragging:!1,isFirst:1===t,isLast:t===u.length-1,direction:O,parent:w},i.aGutterSize=L,i.bGutterSize=L,i.isFirst&&(i.aGutterSize=L/2),i.isLast&&(i.bGutterSize=L/2),"row-reverse"===D||"column-reverse"===D)){var a=i.a;i.a=i.b,i.b=a}if(!o&&t>0){var c=C(t,O);h(c,L),c[n]("mousedown",S.bind(i)),c[n]("touchstart",S.bind(i)),w.insertBefore(c,s.element),i.gutter=c}0===t||t===u.length-1?z(s.element,s.size,L/2):z(s.element,s.size,L);var f=s.element[r]()[y];return f<s.minSize&&(s.minSize=f),t>0&&F.push(i),s}),o?{setSizes:v,destroy:p}:{setSizes:v,getSizes:function(){return E.map(function(e){return e.size})},collapse:function(e){if(e===F.length){var t=F[e-1];g.call(t),o||f.call(t,t.size-t.bGutterSize)}else{var n=F[e];g.call(n),o||f.call(n,n.aGutterSize)}},destroy:p}}});

///////////////////////////////////////////////

///////////////////////////////////////////////
// Copyright (c) 2013 Pieroxy <pieroxy@pieroxy.net>
// This work is free. You can redistribute it and/or modify it
// under the terms of the WTFPL, Version 2
// For more information see LICENSE.txt or http://www.wtfpl.net/
//
// For more information, the home page:
// http://pieroxy.net/blog/pages/lz-string/testing.html
//
// LZ-based compression algorithm, version 1.4.4
var LZString=function(){var o=String.fromCharCode,i={};var n={decompressFromBase64:function(o){return null==o?"":""==o?null:n._decompress(o.length,32,function(n){return function(o,n){if(!i[o]){i[o]={};for(var t=0;t<o.length;t++)i[o][o.charAt(t)]=t}return i[o][n]}("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",o.charAt(n))})},_decompress:function(i,n,t){var r,e,a,s,p,u,l,f=[],c=4,d=4,h=3,v="",g=[],m={val:t(0),position:n,index:1};for(r=0;r<3;r+=1)f[r]=r;for(a=0,p=Math.pow(2,2),u=1;u!=p;)s=m.val&m.position,m.position>>=1,0==m.position&&(m.position=n,m.val=t(m.index++)),a|=(s>0?1:0)*u,u<<=1;switch(a){case 0:for(a=0,p=Math.pow(2,8),u=1;u!=p;)s=m.val&m.position,m.position>>=1,0==m.position&&(m.position=n,m.val=t(m.index++)),a|=(s>0?1:0)*u,u<<=1;l=o(a);break;case 1:for(a=0,p=Math.pow(2,16),u=1;u!=p;)s=m.val&m.position,m.position>>=1,0==m.position&&(m.position=n,m.val=t(m.index++)),a|=(s>0?1:0)*u,u<<=1;l=o(a);break;case 2:return""}for(f[3]=l,e=l,g.push(l);;){if(m.index>i)return"";for(a=0,p=Math.pow(2,h),u=1;u!=p;)s=m.val&m.position,m.position>>=1,0==m.position&&(m.position=n,m.val=t(m.index++)),a|=(s>0?1:0)*u,u<<=1;switch(l=a){case 0:for(a=0,p=Math.pow(2,8),u=1;u!=p;)s=m.val&m.position,m.position>>=1,0==m.position&&(m.position=n,m.val=t(m.index++)),a|=(s>0?1:0)*u,u<<=1;f[d++]=o(a),l=d-1,c--;break;case 1:for(a=0,p=Math.pow(2,16),u=1;u!=p;)s=m.val&m.position,m.position>>=1,0==m.position&&(m.position=n,m.val=t(m.index++)),a|=(s>0?1:0)*u,u<<=1;f[d++]=o(a),l=d-1,c--;break;case 2:return g.join("")}if(0==c&&(c=Math.pow(2,h),h++),f[l])v=f[l];else{if(l!==d)return null;v=e+e.charAt(0)}g.push(v),f[d++]=e+v.charAt(0),e=v,0==--c&&(c=Math.pow(2,h),h++)}}};return n}();"function"==typeof define&&define.amd?define(function(){return LZString}):"undefined"!=typeof module&&null!=module?module.exports=LZString:"undefined"!=typeof angular&&null!=angular&&angular.module("LZString",[]).factory("LZString",function(){return LZString});
///////////////////////////////////////////////

///////////////////////////////////////////////
/*!
 * PEP v0.4.3 | https://github.com/jquery/PEP
 * Copyright jQuery Foundation and other contributors | http://jquery.org/license
 */
!function(a,b){"object"==typeof exports&&"undefined"!=typeof module?module.exports=b():"function"==typeof define&&define.amd?define(b):a.PointerEventsPolyfill=b()}(this,function(){"use strict";function a(a,b){b=b||Object.create(null);var c=document.createEvent("Event");c.initEvent(a,b.bubbles||!1,b.cancelable||!1);
for(var d,e=2;e<m.length;e++)d=m[e],c[d]=b[d]||n[e];c.buttons=b.buttons||0;
var f=0;return f=b.pressure&&c.buttons?b.pressure:c.buttons?.5:0,c.x=c.clientX,c.y=c.clientY,c.pointerId=b.pointerId||0,c.width=b.width||0,c.height=b.height||0,c.pressure=f,c.tiltX=b.tiltX||0,c.tiltY=b.tiltY||0,c.twist=b.twist||0,c.tangentialPressure=b.tangentialPressure||0,c.pointerType=b.pointerType||"",c.hwTimestamp=b.hwTimestamp||0,c.isPrimary=b.isPrimary||!1,c}function b(){this.array=[],this.size=0}function c(a,b,c,d){this.addCallback=a.bind(d),this.removeCallback=b.bind(d),this.changedCallback=c.bind(d),A&&(this.observer=new A(this.mutationWatcher.bind(this)))}function d(a){return"body /shadow-deep/ "+e(a)}function e(a){return'[touch-action="'+a+'"]'}function f(a){return"{ -ms-touch-action: "+a+"; touch-action: "+a+"; }"}function g(){if(F){D.forEach(function(a){String(a)===a?(E+=e(a)+f(a)+"\n",G&&(E+=d(a)+f(a)+"\n")):(E+=a.selectors.map(e)+f(a.rule)+"\n",G&&(E+=a.selectors.map(d)+f(a.rule)+"\n"))});var a=document.createElement("style");a.textContent=E,document.head.appendChild(a)}}function h(){if(!window.PointerEvent){if(window.PointerEvent=a,window.navigator.msPointerEnabled){var b=window.navigator.msMaxTouchPoints;Object.defineProperty(window.navigator,"maxTouchPoints",{value:b,enumerable:!0}),u.registerSource("ms",_)}else Object.defineProperty(window.navigator,"maxTouchPoints",{value:0,enumerable:!0}),u.registerSource("mouse",N),void 0!==window.ontouchstart&&u.registerSource("touch",V);u.register(document)}}function i(a){if(!u.pointermap.has(a)){var b=new Error("InvalidPointerId");throw b.name="InvalidPointerId",b}}function j(a){for(var b=a.parentNode;b&&b!==a.ownerDocument;)b=b.parentNode;if(!b){var c=new Error("InvalidStateError");throw c.name="InvalidStateError",c}}function k(a){var b=u.pointermap.get(a);return 0!==b.buttons}function l(){window.Element&&!Element.prototype.setPointerCapture&&Object.defineProperties(Element.prototype,{setPointerCapture:{value:W},releasePointerCapture:{value:X},hasPointerCapture:{value:Y}})}
var m=["bubbles","cancelable","view","detail","screenX","screenY","clientX","clientY","ctrlKey","altKey","shiftKey","metaKey","button","relatedTarget","pageX","pageY"],n=[!1,!1,null,null,0,0,0,0,!1,!1,!1,!1,0,null,0,0],o=window.Map&&window.Map.prototype.forEach,p=o?Map:b;b.prototype={set:function(a,b){return void 0===b?this["delete"](a):(this.has(a)||this.size++,void(this.array[a]=b))},has:function(a){return void 0!==this.array[a]},"delete":function(a){this.has(a)&&(delete this.array[a],this.size--)},get:function(a){return this.array[a]},clear:function(){this.array.length=0,this.size=0},forEach:function(a,b){return this.array.forEach(function(c,d){a.call(b,c,d,this)},this)}};var q=["bubbles","cancelable","view","detail","screenX","screenY","clientX","clientY","ctrlKey","altKey","shiftKey","metaKey","button","relatedTarget","buttons","pointerId","width","height","pressure","tiltX","tiltY","pointerType","hwTimestamp","isPrimary","type","target","currentTarget","which","pageX","pageY","timeStamp"],r=[!1,!1,null,null,0,0,0,0,!1,!1,!1,!1,0,null,0,0,0,0,0,0,0,"",0,!1,"",null,null,0,0,0,0],s={pointerover:1,pointerout:1,pointerenter:1,pointerleave:1},t="undefined"!=typeof SVGElementInstance,u={pointermap:new p,eventMap:Object.create(null),captureInfo:Object.create(null),eventSources:Object.create(null),eventSourceList:[],registerSource:function(a,b){var c=b,d=c.events;d&&(d.forEach(function(a){c[a]&&(this.eventMap[a]=c[a].bind(c))},this),this.eventSources[a]=c,this.eventSourceList.push(c))},register:function(a){for(var b,c=this.eventSourceList.length,d=0;d<c&&(b=this.eventSourceList[d]);d++)
b.register.call(b,a)},unregister:function(a){for(var b,c=this.eventSourceList.length,d=0;d<c&&(b=this.eventSourceList[d]);d++)
b.unregister.call(b,a)},contains:function(a,b){try{return a.contains(b)}catch(c){return!1}},down:function(a){a.bubbles=!0,this.fireEvent("pointerdown",a)},move:function(a){a.bubbles=!0,this.fireEvent("pointermove",a)},up:function(a){a.bubbles=!0,this.fireEvent("pointerup",a)},enter:function(a){a.bubbles=!1,this.fireEvent("pointerenter",a)},leave:function(a){a.bubbles=!1,this.fireEvent("pointerleave",a)},over:function(a){a.bubbles=!0,this.fireEvent("pointerover",a)},out:function(a){a.bubbles=!0,this.fireEvent("pointerout",a)},cancel:function(a){a.bubbles=!0,this.fireEvent("pointercancel",a)},leaveOut:function(a){this.out(a),this.propagate(a,this.leave,!1)},enterOver:function(a){this.over(a),this.propagate(a,this.enter,!0)},eventHandler:function(a){if(!a._handledByPE){var b=a.type,c=this.eventMap&&this.eventMap[b];c&&c(a),a._handledByPE=!0}},listen:function(a,b){b.forEach(function(b){this.addEvent(a,b)},this)},unlisten:function(a,b){b.forEach(function(b){this.removeEvent(a,b)},this)},addEvent:function(a,b){a.addEventListener(b,this.boundHandler)},removeEvent:function(a,b){a.removeEventListener(b,this.boundHandler)},makeEvent:function(b,c){this.captureInfo[c.pointerId]&&(c.relatedTarget=null);var d=new a(b,c);return c.preventDefault&&(d.preventDefault=c.preventDefault),d._target=d._target||c.target,d},fireEvent:function(a,b){var c=this.makeEvent(a,b);return this.dispatchEvent(c)},cloneEvent:function(a){for(var b,c=Object.create(null),d=0;d<q.length;d++)b=q[d],c[b]=a[b]||r[d],!t||"target"!==b&&"relatedTarget"!==b||c[b]instanceof SVGElementInstance&&(c[b]=c[b].correspondingUseElement);return a.preventDefault&&(c.preventDefault=function(){a.preventDefault()}),c},getTarget:function(a){var b=this.captureInfo[a.pointerId];return b?a._target!==b&&a.type in s?void 0:b:a._target},propagate:function(a,b,c){for(var d=a.target,e=[];d!==document&&!d.contains(a.relatedTarget);) if(e.push(d),d=d.parentNode,!d)return;c&&e.reverse(),e.forEach(function(c){a.target=c,b.call(this,a)},this)},setCapture:function(b,c,d){this.captureInfo[b]&&this.releaseCapture(b,d),this.captureInfo[b]=c,this.implicitRelease=this.releaseCapture.bind(this,b,d),document.addEventListener("pointerup",this.implicitRelease),document.addEventListener("pointercancel",this.implicitRelease);var e=new a("gotpointercapture");e.pointerId=b,e._target=c,d||this.asyncDispatchEvent(e)},releaseCapture:function(b,c){var d=this.captureInfo[b];if(d){this.captureInfo[b]=void 0,document.removeEventListener("pointerup",this.implicitRelease),document.removeEventListener("pointercancel",this.implicitRelease);var e=new a("lostpointercapture");e.pointerId=b,e._target=d,c||this.asyncDispatchEvent(e)}},dispatchEvent:/*scope.external.dispatchEvent || */function(a){var b=this.getTarget(a);if(b)return b.dispatchEvent(a)},asyncDispatchEvent:function(a){requestAnimationFrame(this.dispatchEvent.bind(this,a))}};u.boundHandler=u.eventHandler.bind(u);var v={shadow:function(a){if(a)return a.shadowRoot||a.webkitShadowRoot},canTarget:function(a){return a&&Boolean(a.elementFromPoint)},targetingShadow:function(a){var b=this.shadow(a);if(this.canTarget(b))return b},olderShadow:function(a){var b=a.olderShadowRoot;if(!b){var c=a.querySelector("shadow");c&&(b=c.olderShadowRoot)}return b},allShadows:function(a){for(var b=[],c=this.shadow(a);c;)b.push(c),c=this.olderShadow(c);return b},searchRoot:function(a,b,c){if(a){var d,e,f=a.elementFromPoint(b,c);for(e=this.targetingShadow(f);e;){if(d=e.elementFromPoint(b,c)){var g=this.targetingShadow(d);return this.searchRoot(g,b,c)||d} e=this.olderShadow(e)} return f}},owner:function(a){
for(var b=a;b.parentNode;)b=b.parentNode;
return b.nodeType!==Node.DOCUMENT_NODE&&b.nodeType!==Node.DOCUMENT_FRAGMENT_NODE&&(b=document),b},findTarget:function(a){var b=a.clientX,c=a.clientY,d=this.owner(a.target);
return d.elementFromPoint(b,c)||(d=document),this.searchRoot(d,b,c)}},w=Array.prototype.forEach.call.bind(Array.prototype.forEach),x=Array.prototype.map.call.bind(Array.prototype.map),y=Array.prototype.slice.call.bind(Array.prototype.slice),z=Array.prototype.filter.call.bind(Array.prototype.filter),A=window.MutationObserver||window.WebKitMutationObserver,B="[touch-action]",C={subtree:!0,childList:!0,attributes:!0,attributeOldValue:!0,attributeFilter:["touch-action"]};c.prototype={watchSubtree:function(a){
//
this.observer&&v.canTarget(a)&&this.observer.observe(a,C)},enableOnSubtree:function(a){this.watchSubtree(a),a===document&&"complete"!==document.readyState?this.installOnLoad():this.installNewSubtree(a)},installNewSubtree:function(a){w(this.findElements(a),this.addElement,this)},findElements:function(a){return a.querySelectorAll?a.querySelectorAll(B):[]},removeElement:function(a){this.removeCallback(a)},addElement:function(a){this.addCallback(a)},elementChanged:function(a,b){this.changedCallback(a,b)},concatLists:function(a,b){return a.concat(y(b))},
installOnLoad:function(){document.addEventListener("readystatechange",function(){"complete"===document.readyState&&this.installNewSubtree(document)}.bind(this))},isElement:function(a){return a.nodeType===Node.ELEMENT_NODE},flattenMutationTree:function(a){
var b=x(a,this.findElements,this);
return b.push(z(a,this.isElement)),b.reduce(this.concatLists,[])},mutationWatcher:function(a){a.forEach(this.mutationHandler,this)},mutationHandler:function(a){if("childList"===a.type){var b=this.flattenMutationTree(a.addedNodes);b.forEach(this.addElement,this);var c=this.flattenMutationTree(a.removedNodes);c.forEach(this.removeElement,this)}else"attributes"===a.type&&this.elementChanged(a.target,a.oldValue)}};var D=["none","auto","pan-x","pan-y",{rule:"pan-x pan-y",selectors:["pan-x pan-y","pan-y pan-x"]}],E="",F=window.PointerEvent||window.MSPointerEvent,G=!window.ShadowDOMPolyfill&&document.head.createShadowRoot,H=u.pointermap,I=25,J=[1,4,2,8,16],K=!1;try{K=1===new MouseEvent("test",{buttons:1}).buttons}catch(L){}
var M,N={POINTER_ID:1,POINTER_TYPE:"mouse",events:["mousedown","mousemove","mouseup","mouseover","mouseout"],register:function(a){u.listen(a,this.events)},unregister:function(a){u.unlisten(a,this.events)},lastTouches:[],
isEventSimulatedFromTouch:function(a){for(var b,c=this.lastTouches,d=a.clientX,e=a.clientY,f=0,g=c.length;f<g&&(b=c[f]);f++){
var h=Math.abs(d-b.x),i=Math.abs(e-b.y);if(h<=I&&i<=I)return!0}},prepareEvent:function(a){var b=u.cloneEvent(a),c=b.preventDefault;return b.preventDefault=function(){a.preventDefault(),c()},b.pointerId=this.POINTER_ID,b.isPrimary=!0,b.pointerType=this.POINTER_TYPE,b},prepareButtonsForMove:function(a,b){var c=H.get(this.POINTER_ID);
0!==b.which&&c?a.buttons=c.buttons:a.buttons=0,b.buttons=a.buttons},mousedown:function(a){if(!this.isEventSimulatedFromTouch(a)){var b=H.get(this.POINTER_ID),c=this.prepareEvent(a);K||(c.buttons=J[c.button],b&&(c.buttons|=b.buttons),a.buttons=c.buttons),H.set(this.POINTER_ID,a),b&&0!==b.buttons?u.move(c):u.down(c)}},mousemove:function(a){if(!this.isEventSimulatedFromTouch(a)){var b=this.prepareEvent(a);K||this.prepareButtonsForMove(b,a),b.button=-1,H.set(this.POINTER_ID,a),u.move(b)}},mouseup:function(a){if(!this.isEventSimulatedFromTouch(a)){var b=H.get(this.POINTER_ID),c=this.prepareEvent(a);if(!K){var d=J[c.button];
c.buttons=b?b.buttons&~d:0,a.buttons=c.buttons}H.set(this.POINTER_ID,a),
c.buttons&=~J[c.button],0===c.buttons?u.up(c):u.move(c)}},mouseover:function(a){if(!this.isEventSimulatedFromTouch(a)){var b=this.prepareEvent(a);K||this.prepareButtonsForMove(b,a),b.button=-1,H.set(this.POINTER_ID,a),u.enterOver(b)}},mouseout:function(a){if(!this.isEventSimulatedFromTouch(a)){var b=this.prepareEvent(a);K||this.prepareButtonsForMove(b,a),b.button=-1,u.leaveOut(b)}},cancel:function(a){var b=this.prepareEvent(a);u.cancel(b),this.deactivateMouse()},deactivateMouse:function(){H["delete"](this.POINTER_ID)}},O=u.captureInfo,P=v.findTarget.bind(v),Q=v.allShadows.bind(v),R=u.pointermap,S=2500,T=200,U="touch-action",V={events:["touchstart","touchmove","touchend","touchcancel"],register:function(a){M.enableOnSubtree(a)},unregister:function(){},elementAdded:function(a){var b=a.getAttribute(U),c=this.touchActionToScrollType(b);c&&(a._scrollType=c,u.listen(a,this.events),
Q(a).forEach(function(a){a._scrollType=c,u.listen(a,this.events)},this))},elementRemoved:function(a){a._scrollType=void 0,u.unlisten(a,this.events),
Q(a).forEach(function(a){a._scrollType=void 0,u.unlisten(a,this.events)},this)},elementChanged:function(a,b){var c=a.getAttribute(U),d=this.touchActionToScrollType(c),e=this.touchActionToScrollType(b);
d&&e?(a._scrollType=d,Q(a).forEach(function(a){a._scrollType=d},this)):e?this.elementRemoved(a):d&&this.elementAdded(a)},scrollTypes:{EMITTER:"none",XSCROLLER:"pan-x",YSCROLLER:"pan-y",SCROLLER:/^(?:pan-x pan-y)|(?:pan-y pan-x)|auto$/},touchActionToScrollType:function(a){var b=a,c=this.scrollTypes;return"none"===b?"none":b===c.XSCROLLER?"X":b===c.YSCROLLER?"Y":c.SCROLLER.exec(b)?"XY":void 0},POINTER_TYPE:"touch",firstTouch:null,isPrimaryTouch:function(a){return this.firstTouch===a.identifier},setPrimaryTouch:function(a){
(0===R.size||1===R.size&&R.has(1))&&(this.firstTouch=a.identifier,this.firstXY={X:a.clientX,Y:a.clientY},this.scrolling=!1,this.cancelResetClickCount())},removePrimaryPointer:function(a){a.isPrimary&&(this.firstTouch=null,this.firstXY=null,this.resetClickCount())},clickCount:0,resetId:null,resetClickCount:function(){var a=function(){this.clickCount=0,this.resetId=null}.bind(this);this.resetId=setTimeout(a,T)},cancelResetClickCount:function(){this.resetId&&clearTimeout(this.resetId)},typeToButtons:function(a){var b=0;return"touchstart"!==a&&"touchmove"!==a||(b=1),b},touchToPointer:function(a){var b=this.currentTouchEvent,c=u.cloneEvent(a),d=c.pointerId=a.identifier+2;c.target=O[d]||P(c),c.bubbles=!0,c.cancelable=!0,c.detail=this.clickCount,c.button=0,c.buttons=this.typeToButtons(b.type),c.width=2*(a.radiusX||a.webkitRadiusX||0),c.height=2*(a.radiusY||a.webkitRadiusY||0),c.pressure=a.force||a.webkitForce||.5,c.isPrimary=this.isPrimaryTouch(a),c.pointerType=this.POINTER_TYPE,
c.altKey=b.altKey,c.ctrlKey=b.ctrlKey,c.metaKey=b.metaKey,c.shiftKey=b.shiftKey;
var e=this;return c.preventDefault=function(){e.scrolling=!1,e.firstXY=null,b.preventDefault()},c},processTouches:function(a,b){var c=a.changedTouches;this.currentTouchEvent=a;for(var d,e=0;e<c.length;e++)d=c[e],b.call(this,this.touchToPointer(d))},
shouldScroll:function(a){if(this.firstXY){var b,c=a.currentTarget._scrollType;if("none"===c)
b=!1;else if("XY"===c)
b=!0;else{var d=a.changedTouches[0],e=c,f="Y"===c?"X":"Y",g=Math.abs(d["client"+e]-this.firstXY[e]),h=Math.abs(d["client"+f]-this.firstXY[f]);
b=g>=h}return this.firstXY=null,b}},findTouch:function(a,b){for(var c,d=0,e=a.length;d<e&&(c=a[d]);d++)if(c.identifier===b)return!0},
vacuumTouches:function(a){var b=a.touches;
if(R.size>=b.length){var c=[];R.forEach(function(a,d){
if(1!==d&&!this.findTouch(b,d-2)){var e=a.out;c.push(e)}},this),c.forEach(this.cancelOut,this)}},touchstart:function(a){this.vacuumTouches(a),this.setPrimaryTouch(a.changedTouches[0]),this.dedupSynthMouse(a),this.scrolling||(this.clickCount++,this.processTouches(a,this.overDown))},overDown:function(a){R.set(a.pointerId,{target:a.target,out:a,outTarget:a.target}),u.enterOver(a),u.down(a)},touchmove:function(a){this.scrolling||(this.shouldScroll(a)?(this.scrolling=!0,this.touchcancel(a)):(a.preventDefault(),this.processTouches(a,this.moveOverOut)))},moveOverOut:function(a){var b=a,c=R.get(b.pointerId);
if(c){var d=c.out,e=c.outTarget;u.move(b),d&&e!==b.target&&(d.relatedTarget=b.target,b.relatedTarget=e,
d.target=e,b.target?(u.leaveOut(d),u.enterOver(b)):(
b.target=e,b.relatedTarget=null,this.cancelOut(b))),c.out=b,c.outTarget=b.target}},touchend:function(a){this.dedupSynthMouse(a),this.processTouches(a,this.upOut)},upOut:function(a){this.scrolling||(u.up(a),u.leaveOut(a)),this.cleanUpPointer(a)},touchcancel:function(a){this.processTouches(a,this.cancelOut)},cancelOut:function(a){u.cancel(a),u.leaveOut(a),this.cleanUpPointer(a)},cleanUpPointer:function(a){R["delete"](a.pointerId),this.removePrimaryPointer(a)},
dedupSynthMouse:function(a){var b=N.lastTouches,c=a.changedTouches[0];
if(this.isPrimaryTouch(c)){
var d={x:c.clientX,y:c.clientY};b.push(d);var e=function(a,b){var c=a.indexOf(b);c>-1&&a.splice(c,1)}.bind(null,b,d);setTimeout(e,S)}}};M=new c(V.elementAdded,V.elementRemoved,V.elementChanged,V);var W,X,Y,Z=u.pointermap,$=window.MSPointerEvent&&"number"==typeof window.MSPointerEvent.MSPOINTER_TYPE_MOUSE,_={events:["MSPointerDown","MSPointerMove","MSPointerUp","MSPointerOut","MSPointerOver","MSPointerCancel","MSGotPointerCapture","MSLostPointerCapture"],register:function(a){u.listen(a,this.events)},unregister:function(a){u.unlisten(a,this.events)},POINTER_TYPES:["","unavailable","touch","pen","mouse"],prepareEvent:function(a){var b=a;return $&&(b=u.cloneEvent(a),b.pointerType=this.POINTER_TYPES[a.pointerType]),b},cleanup:function(a){Z["delete"](a)},MSPointerDown:function(a){Z.set(a.pointerId,a);var b=this.prepareEvent(a);u.down(b)},MSPointerMove:function(a){var b=this.prepareEvent(a);u.move(b)},MSPointerUp:function(a){var b=this.prepareEvent(a);u.up(b),this.cleanup(a.pointerId)},MSPointerOut:function(a){var b=this.prepareEvent(a);u.leaveOut(b)},MSPointerOver:function(a){var b=this.prepareEvent(a);u.enterOver(b)},MSPointerCancel:function(a){var b=this.prepareEvent(a);u.cancel(b),this.cleanup(a.pointerId)},MSLostPointerCapture:function(a){var b=u.makeEvent("lostpointercapture",a);u.dispatchEvent(b)},MSGotPointerCapture:function(a){var b=u.makeEvent("gotpointercapture",a);u.dispatchEvent(b)}},aa=window.navigator;aa.msPointerEnabled?(W=function(a){i(a),j(this),k(a)&&(u.setCapture(a,this,!0),this.msSetPointerCapture(a))},X=function(a){i(a),u.releaseCapture(a,!0),this.msReleasePointerCapture(a)}):(W=function(a){i(a),j(this),k(a)&&u.setCapture(a,this)},X=function(a){i(a),u.releaseCapture(a)}),Y=function(a){return!!u.captureInfo[a]},g(),h(),l();var ba={dispatcher:u,Installer:c,PointerEvent:a,PointerMap:p,targetFinding:v};return ba});

///////////////////////////////////////////////

///////////////////////////////////////////////
var config = {"dark_mode": false, "show_pads": true, "show_fabrication": false, "show_silkscreen": true, "highlight_pin1": "none", "redraw_on_drag": true, "board_rotation": 0, "checkboxes": "Sourced,Placed", "bom_view": "left-right", "layer_view": "FB", "offset_back_rotation": false, "kicad_text_formatting": true, "fields": ["Value", "Footprint"]}
///////////////////////////////////////////////

///////////////////////////////////////////////
var pcbdata = JSON.parse(LZString.decompressFromBase64("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"))
///////////////////////////////////////////////

///////////////////////////////////////////////
/* Utility functions */

var storagePrefix = 'KiCad_HTML_BOM__' + pcbdata.metadata.title + '__' +
  pcbdata.metadata.revision + '__#';
var storage;

function initStorage(key) {
  try {
    window.localStorage.getItem("blank");
    storage = window.localStorage;
  } catch (e) {
    // localStorage not available
  }
  if (!storage) {
    try {
      window.sessionStorage.getItem("blank");
      storage = window.sessionStorage;
    } catch (e) {
      // sessionStorage also not available
    }
  }
}

function readStorage(key) {
  if (storage) {
    return storage.getItem(storagePrefix + key);
  } else {
    return null;
  }
}

function writeStorage(key, value) {
  if (storage) {
    storage.setItem(storagePrefix + key, value);
  }
}

function fancyDblClickHandler(el, onsingle, ondouble) {
  return function () {
    if (el.getAttribute("data-dblclick") == null) {
      el.setAttribute("data-dblclick", 1);
      setTimeout(function () {
        if (el.getAttribute("data-dblclick") == 1) {
          onsingle();
        }
        el.removeAttribute("data-dblclick");
      }, 200);
    } else {
      el.removeAttribute("data-dblclick");
      ondouble();
    }
  }
}

function smoothScrollToRow(rowid) {
  document.getElementById(rowid).scrollIntoView({
    behavior: "smooth",
    block: "center",
    inline: "nearest"
  });
}

function focusInputField(input) {
  input.scrollIntoView(false);
  input.focus();
  input.select();
}

function saveBomTable(output) {
  var text = '';
  for (var node of bomhead.childNodes[0].childNodes) {
    if (node.firstChild) {
      text += (output == 'csv' ? `"${node.firstChild.nodeValue}"` : node.firstChild.nodeValue);
    }
    if (node != bomhead.childNodes[0].lastChild) {
      text += (output == 'csv' ? ',' : '\t');
    }
  }
  text += '\n';
  for (var row of bombody.childNodes) {
    for (var cell of row.childNodes) {
      let val = '';
      for (var node of cell.childNodes) {
        if (node.nodeName == "INPUT") {
          if (node.checked) {
            val += '';
          }
        } else if ((node.nodeName == "MARK") || (node.nodeName == "A")) {
          val += node.firstChild.nodeValue;
        } else {
          val += node.nodeValue;
        }
      }
      if (output == 'csv') {
        val = val.replace(/\"/g, '\"\"'); // pair of double-quote characters
        if (isNumeric(val)) {
          val = +val;                     // use number
        } else {
          val = `"${val}"`;               // enclosed within double-quote
        }
      }
      text += val;
      if (cell != row.lastChild) {
        text += (output == 'csv' ? ',' : '\t');
      }
    }
    text += '\n';
  }

  if (output != 'clipboard') {
    // To file: csv or txt
    var blob = new Blob([text], {
      type: `text/${output}`
    });
    saveFile(`${pcbdata.metadata.title}.${output}`, blob);
  } else {
    // To clipboard
    var textArea = document.createElement("textarea");
    textArea.classList.add('clipboard-temp');
    textArea.value = text;

    document.body.appendChild(textArea);
    textArea.focus();
    textArea.select();

    try {
      if (document.execCommand('copy')) {
        console.log('Bom copied to clipboard.');
      }
    } catch (err) {
      console.log('Can not copy to clipboard.');
    }

    document.body.removeChild(textArea);
  }
}

function isNumeric(str) {
  /* https://stackoverflow.com/a/175787 */
  return (typeof str != "string" ? false : !isNaN(str) && !isNaN(parseFloat(str)));
}

function removeGutterNode(node) {
  for (var i = 0; i < node.childNodes.length; i++) {
    if (node.childNodes[i].classList &&
      node.childNodes[i].classList.contains("gutter")) {
      node.removeChild(node.childNodes[i]);
      break;
    }
  }
}

function cleanGutters() {
  removeGutterNode(document.getElementById("bot"));
  removeGutterNode(document.getElementById("canvasdiv"));
}

var units = {
  prefixes: {
    giga: ["G", "g", "giga", "Giga", "GIGA"],
    mega: ["M", "mega", "Mega", "MEGA"],
    kilo: ["K", "k", "kilo", "Kilo", "KILO"],
    milli: ["m", "milli", "Milli", "MILLI"],
    micro: ["U", "u", "micro", "Micro", "MICRO", "", ""], // different utf8 
    nano: ["N", "n", "nano", "Nano", "NANO"],
    pico: ["P", "p", "pico", "Pico", "PICO"],
  },
  unitsShort: ["R", "r", "", "F", "f", "H", "h"],
  unitsLong: [
    "OHM", "Ohm", "ohm", "ohms",
    "FARAD", "Farad", "farad",
    "HENRY", "Henry", "henry"
  ],
  getMultiplier: function (s) {
    if (this.prefixes.giga.includes(s)) return 1e9;
    if (this.prefixes.mega.includes(s)) return 1e6;
    if (this.prefixes.kilo.includes(s)) return 1e3;
    if (this.prefixes.milli.includes(s)) return 1e-3;
    if (this.prefixes.micro.includes(s)) return 1e-6;
    if (this.prefixes.nano.includes(s)) return 1e-9;
    if (this.prefixes.pico.includes(s)) return 1e-12;
    return 1;
  },
  valueRegex: null,
}

function initUtils() {
  var allPrefixes = units.prefixes.giga
    .concat(units.prefixes.mega)
    .concat(units.prefixes.kilo)
    .concat(units.prefixes.milli)
    .concat(units.prefixes.micro)
    .concat(units.prefixes.nano)
    .concat(units.prefixes.pico);
  var allUnits = units.unitsShort.concat(units.unitsLong);
  units.valueRegex = new RegExp("^([0-9\.]+)" +
    "\\s*(" + allPrefixes.join("|") + ")?" +
    "(" + allUnits.join("|") + ")?" +
    "(\\b.*)?$", "");
  units.valueAltRegex = new RegExp("^([0-9]*)" +
    "(" + units.unitsShort.join("|") + ")?" +
    "([GgMmKkUuNnPp])?" +
    "([0-9]*)" +
    "(\\b.*)?$", "");
  if (config.fields.includes("Value")) {
    var index = config.fields.indexOf("Value");
    pcbdata.bom["parsedValues"] = {};
    for (var id in pcbdata.bom.fields) {
      pcbdata.bom.parsedValues[id] = parseValue(pcbdata.bom.fields[id][index])
    }
  }
}

function parseValue(val, ref) {
  var inferUnit = (unit, ref) => {
    if (unit) {
      unit = unit.toLowerCase();
      if (unit == '' || unit == "ohm" || unit == "ohms") {
        unit = 'r';
      }
      unit = unit[0];
    } else {
      ref = /^([a-z]+)\d+$/i.exec(ref);
      if (ref) {
        ref = ref[1].toLowerCase();
        if (ref == "c") unit = 'f';
        else if (ref == "l") unit = 'h';
        else if (ref == "r" || ref == "rv") unit = 'r';
        else unit = null;
      }
    }
    return unit;
  };
  val = val.replace(/,/g, "");
  var match = units.valueRegex.exec(val);
  var unit;
  if (match) {
    val = parseFloat(match[1]);
    if (match[2]) {
      val = val * units.getMultiplier(match[2]);
    }
    unit = inferUnit(match[3], ref);
    if (!unit) return null;
    else return {
      val: val,
      unit: unit,
      extra: match[4],
    }
  }
  match = units.valueAltRegex.exec(val);
  if (match && (match[1] || match[4])) {
    val = parseFloat(match[1] + "." + match[4]);
    if (match[3]) {
      val = val * units.getMultiplier(match[3]);
    }
    unit = inferUnit(match[2], ref);
    if (!unit) return null;
    else return {
      val: val,
      unit: unit,
      extra: match[5],
    }
  }
  return null;
}

function valueCompare(a, b, stra, strb) {
  if (a === null && b === null) {
    // Failed to parse both values, compare them as strings.
    if (stra != strb) return stra > strb ? 1 : -1;
    else return 0;
  } else if (a === null) {
    return 1;
  } else if (b === null) {
    return -1;
  } else {
    if (a.unit != b.unit) return a.unit > b.unit ? 1 : -1;
    else if (a.val != b.val) return a.val > b.val ? 1 : -1;
    else if (a.extra != b.extra) return a.extra > b.extra ? 1 : -1;
    else return 0;
  }
}

function validateSaveImgDimension(element) {
  var valid = false;
  var intValue = 0;
  if (/^[1-9]\d*$/.test(element.value)) {
    intValue = parseInt(element.value);
    if (intValue <= 16000) {
      valid = true;
    }
  }
  if (valid) {
    element.classList.remove("invalid");
  } else {
    element.classList.add("invalid");
  }
  return intValue;
}

function saveImage(layer) {
  var width = validateSaveImgDimension(document.getElementById("render-save-width"));
  var height = validateSaveImgDimension(document.getElementById("render-save-height"));
  var bgcolor = null;
  if (!document.getElementById("render-save-transparent").checked) {
    var style = getComputedStyle(topmostdiv);
    bgcolor = style.getPropertyValue("background-color");
  }
  if (!width || !height) return;

  // Prepare image
  var canvas = document.createElement("canvas");
  var layerdict = {
    transform: {
      x: 0,
      y: 0,
      s: 1,
      panx: 0,
      pany: 0,
      zoom: 1,
    },
    bg: canvas,
    fab: canvas,
    silk: canvas,
    highlight: canvas,
    layer: layer,
  }
  // Do the rendering
  recalcLayerScale(layerdict, width, height);
  prepareLayer(layerdict);
  clearCanvas(canvas, bgcolor);
  drawBackground(layerdict, false);
  drawHighlightsOnLayer(layerdict, false);

  // Save image
  var imgdata = canvas.toDataURL("image/png");

  var filename = pcbdata.metadata.title;
  if (pcbdata.metadata.revision) {
    filename += `.${pcbdata.metadata.revision}`;
  }
  filename += `.${layer}.png`;
  saveFile(filename, dataURLtoBlob(imgdata));
}

function saveSettings() {
  var data = {
    type: "InteractiveHtmlBom settings",
    version: 1,
    pcbmetadata: pcbdata.metadata,
    settings: settings,
  }
  var blob = new Blob([JSON.stringify(data, null, 4)], {
    type: "application/json"
  });
  saveFile(`${pcbdata.metadata.title}.settings.json`, blob);
}

function loadSettings() {
  var input = document.createElement("input");
  input.type = "file";
  input.accept = ".settings.json";
  input.onchange = function (e) {
    var file = e.target.files[0];
    var reader = new FileReader();
    reader.onload = readerEvent => {
      var content = readerEvent.target.result;
      var newSettings;
      try {
        newSettings = JSON.parse(content);
      } catch (e) {
        alert("Selected file is not InteractiveHtmlBom settings file.");
        return;
      }
      if (newSettings.type != "InteractiveHtmlBom settings") {
        alert("Selected file is not InteractiveHtmlBom settings file.");
        return;
      }
      var metadataMatches = newSettings.hasOwnProperty("pcbmetadata");
      if (metadataMatches) {
        for (var k in pcbdata.metadata) {
          if (!newSettings.pcbmetadata.hasOwnProperty(k) || newSettings.pcbmetadata[k] != pcbdata.metadata[k]) {
            metadataMatches = false;
          }
        }
      }
      if (!metadataMatches) {
        var currentMetadata = JSON.stringify(pcbdata.metadata, null, 4);
        var fileMetadata = JSON.stringify(newSettings.pcbmetadata, null, 4);
        if (!confirm(
          `Settins file metadata does not match current metadata.\n\n` +
          `Page metadata:\n${currentMetadata}\n\n` +
          `Settings file metadata:\n${fileMetadata}\n\n` +
          `Press OK if you would like to import settings anyway.`)) {
          return;
        }
      }
      overwriteSettings(newSettings.settings);
    }
    reader.readAsText(file, 'UTF-8');
  }
  input.click();
}

function resetSettings() {
  if (!confirm(
    `This will reset all checkbox states and other settings.\n\n` +
    `Press OK if you want to continue.`)) {
    return;
  }
  if (storage) {
    var keys = [];
    for (var i = 0; i < storage.length; i++) {
      var key = storage.key(i);
      if (key.startsWith(storagePrefix)) keys.push(key);
    }
    for (var key of keys) storage.removeItem(key);
  }
  location.reload();
}

function overwriteSettings(newSettings) {
  initDone = false;
  Object.assign(settings, newSettings);
  writeStorage("bomlayout", settings.bomlayout);
  writeStorage("bommode", settings.bommode);
  writeStorage("canvaslayout", settings.canvaslayout);
  writeStorage("bomCheckboxes", settings.checkboxes.join(","));
  document.getElementById("bomCheckboxes").value = settings.checkboxes.join(",");
  for (var checkbox of settings.checkboxes) {
    writeStorage("checkbox_" + checkbox, settings.checkboxStoredRefs[checkbox]);
  }
  writeStorage("markWhenChecked", settings.markWhenChecked);
  padsVisible(settings.renderPads);
  document.getElementById("padsCheckbox").checked = settings.renderPads;
  fabricationVisible(settings.renderFabrication);
  document.getElementById("fabricationCheckbox").checked = settings.renderFabrication;
  silkscreenVisible(settings.renderSilkscreen);
  document.getElementById("silkscreenCheckbox").checked = settings.renderSilkscreen;
  referencesVisible(settings.renderReferences);
  document.getElementById("referencesCheckbox").checked = settings.renderReferences;
  valuesVisible(settings.renderValues);
  document.getElementById("valuesCheckbox").checked = settings.renderValues;
  tracksVisible(settings.renderTracks);
  document.getElementById("tracksCheckbox").checked = settings.renderTracks;
  zonesVisible(settings.renderZones);
  document.getElementById("zonesCheckbox").checked = settings.renderZones;
  dnpOutline(settings.renderDnpOutline);
  document.getElementById("dnpOutlineCheckbox").checked = settings.renderDnpOutline;
  setRedrawOnDrag(settings.redrawOnDrag);
  document.getElementById("dragCheckbox").checked = settings.redrawOnDrag;
  setDarkMode(settings.darkMode);
  document.getElementById("darkmodeCheckbox").checked = settings.darkMode;
  setHighlightPin1(settings.highlightpin1);
  document.forms.highlightpin1.highlightpin1.value = settings.highlightpin1;
  writeStorage("boardRotation", settings.boardRotation);
  document.getElementById("boardRotation").value = settings.boardRotation / 5;
  document.getElementById("rotationDegree").textContent = settings.boardRotation;
  setOffsetBackRotation(settings.offsetBackRotation);
  document.getElementById("offsetBackRotationCheckbox").checked = settings.offsetBackRotation;
  initDone = true;
  prepCheckboxes();
  changeBomLayout(settings.bomlayout);
}

function saveFile(filename, blob) {
  var link = document.createElement("a");
  var objurl = URL.createObjectURL(blob);
  link.download = filename;
  link.href = objurl;
  link.click();
}

function dataURLtoBlob(dataurl) {
  var arr = dataurl.split(','),
    mime = arr[0].match(/:(.*?);/)[1],
    bstr = atob(arr[1]),
    n = bstr.length,
    u8arr = new Uint8Array(n);
  while (n--) {
    u8arr[n] = bstr.charCodeAt(n);
  }
  return new Blob([u8arr], {
    type: mime
  });
}

var settings = {
  canvaslayout: "FB",
  bomlayout: "left-right",
  bommode: "grouped",
  checkboxes: [],
  checkboxStoredRefs: {},
  darkMode: false,
  highlightpin1: "none",
  redrawOnDrag: true,
  boardRotation: 0,
  offsetBackRotation: false,
  renderPads: true,
  renderReferences: true,
  renderValues: true,
  renderSilkscreen: true,
  renderFabrication: true,
  renderDnpOutline: false,
  renderTracks: true,
  renderZones: true,
  columnOrder: [],
  hiddenColumns: [],
  netColors: {},
}

function initDefaults() {
  settings.bomlayout = readStorage("bomlayout");
  if (settings.bomlayout === null) {
    settings.bomlayout = config.bom_view;
  }
  if (!['bom-only', 'left-right', 'top-bottom'].includes(settings.bomlayout)) {
    settings.bomlayout = config.bom_view;
  }
  settings.bommode = readStorage("bommode");
  if (settings.bommode === null) {
    settings.bommode = "grouped";
  }
  if (settings.bommode == "netlist" && !pcbdata.nets) {
    settings.bommode = "grouped";
  }
  if (!["grouped", "ungrouped", "netlist"].includes(settings.bommode)) {
    settings.bommode = "grouped";
  }
  settings.canvaslayout = readStorage("canvaslayout");
  if (settings.canvaslayout === null) {
    settings.canvaslayout = config.layer_view;
  }
  var bomCheckboxes = readStorage("bomCheckboxes");
  if (bomCheckboxes === null) {
    bomCheckboxes = config.checkboxes;
  }
  settings.checkboxes = bomCheckboxes.split(",").filter((e) => e);
  document.getElementById("bomCheckboxes").value = bomCheckboxes;

  var highlightpin1 = readStorage("highlightpin1") || config.highlight_pin1;
  if (highlightpin1 === "false") highlightpin1 = "none";
  if (highlightpin1 === "true") highlightpin1 = "all";
  setHighlightPin1(highlightpin1);
  document.forms.highlightpin1.highlightpin1.value = highlightpin1;

  settings.markWhenChecked = readStorage("markWhenChecked") || "";
  populateMarkWhenCheckedOptions();

  function initBooleanSetting(storageString, def, elementId, func) {
    var b = readStorage(storageString);
    if (b === null) {
      b = def;
    } else {
      b = (b == "true");
    }
    document.getElementById(elementId).checked = b;
    func(b);
  }

  initBooleanSetting("padsVisible", config.show_pads, "padsCheckbox", padsVisible);
  initBooleanSetting("fabricationVisible", config.show_fabrication, "fabricationCheckbox", fabricationVisible);
  initBooleanSetting("silkscreenVisible", config.show_silkscreen, "silkscreenCheckbox", silkscreenVisible);
  initBooleanSetting("referencesVisible", true, "referencesCheckbox", referencesVisible);
  initBooleanSetting("valuesVisible", true, "valuesCheckbox", valuesVisible);
  if ("tracks" in pcbdata) {
    initBooleanSetting("tracksVisible", true, "tracksCheckbox", tracksVisible);
    initBooleanSetting("zonesVisible", true, "zonesCheckbox", zonesVisible);
  } else {
    document.getElementById("tracksAndZonesCheckboxes").style.display = "none";
    tracksVisible(false);
    zonesVisible(false);
  }
  initBooleanSetting("dnpOutline", false, "dnpOutlineCheckbox", dnpOutline);
  initBooleanSetting("redrawOnDrag", config.redraw_on_drag, "dragCheckbox", setRedrawOnDrag);
  initBooleanSetting("darkmode", config.dark_mode, "darkmodeCheckbox", setDarkMode);

  var fields = ["checkboxes", "References"].concat(config.fields).concat(["Quantity"]);
  var hcols = JSON.parse(readStorage("hiddenColumns"));
  if (hcols === null) {
    hcols = [];
  }
  settings.hiddenColumns = hcols.filter(e => fields.includes(e));

  var cord = JSON.parse(readStorage("columnOrder"));
  if (cord === null) {
    cord = fields;
  } else {
    cord = cord.filter(e => fields.includes(e));
    if (cord.length != fields.length)
      cord = fields;
  }
  settings.columnOrder = cord;

  settings.boardRotation = readStorage("boardRotation");
  if (settings.boardRotation === null) {
    settings.boardRotation = config.board_rotation * 5;
  } else {
    settings.boardRotation = parseInt(settings.boardRotation);
  }
  document.getElementById("boardRotation").value = settings.boardRotation / 5;
  document.getElementById("rotationDegree").textContent = settings.boardRotation;
  initBooleanSetting("offsetBackRotation", config.offset_back_rotation, "offsetBackRotationCheckbox", setOffsetBackRotation);

  settings.netColors = JSON.parse(readStorage("netColors")) || {};
}

// Helper classes for user js callbacks.

const IBOM_EVENT_TYPES = {
  ALL: "all",
  HIGHLIGHT_EVENT: "highlightEvent",
  CHECKBOX_CHANGE_EVENT: "checkboxChangeEvent",
  BOM_BODY_CHANGE_EVENT: "bomBodyChangeEvent",
}

const EventHandler = {
  callbacks: {},
  init: function () {
    for (eventType of Object.values(IBOM_EVENT_TYPES))
      this.callbacks[eventType] = [];
  },
  registerCallback: function (eventType, callback) {
    this.callbacks[eventType].push(callback);
  },
  emitEvent: function (eventType, eventArgs) {
    event = {
      eventType: eventType,
      args: eventArgs,
    }
    var callback;
    for (callback of this.callbacks[eventType])
      callback(event);
    for (callback of this.callbacks[IBOM_EVENT_TYPES.ALL])
      callback(event);
  }
}
EventHandler.init();

///////////////////////////////////////////////

///////////////////////////////////////////////
/* PCB rendering code */

var emptyContext2d = document.createElement("canvas").getContext("2d");

function deg2rad(deg) {
  return deg * Math.PI / 180;
}

function calcFontPoint(linepoint, text, offsetx, offsety, tilt) {
  var point = [
    linepoint[0] * text.width + offsetx,
    linepoint[1] * text.height + offsety
  ];
  // This approximates pcbnew behavior with how text tilts depending on horizontal justification
  point[0] -= (linepoint[1] + 0.5 * (1 + text.justify[0])) * text.height * tilt;
  return point;
}

function drawText(ctx, text, color) {
  if ("ref" in text && !settings.renderReferences) return;
  if ("val" in text && !settings.renderValues) return;
  ctx.save();
  ctx.fillStyle = color;
  ctx.strokeStyle = color;
  ctx.lineCap = "round";
  ctx.lineJoin = "round";
  ctx.lineWidth = text.thickness;
  if ("svgpath" in text) {
    ctx.stroke(new Path2D(text.svgpath));
    ctx.restore();
    return;
  }
  if ("polygons" in text) {
    ctx.fill(getPolygonsPath(text));
    ctx.restore();
    return;
  }
  ctx.translate(...text.pos);
  ctx.translate(text.thickness * 0.5, 0);
  var angle = -text.angle;
  if (text.attr.includes("mirrored")) {
    ctx.scale(-1, 1);
    angle = -angle;
  }
  var tilt = 0;
  if (text.attr.includes("italic")) {
    tilt = 0.125;
  }
  var interline = text.height * 1.5 + text.thickness;
  var txt = text.text.split("\n");
  // KiCad ignores last empty line.
  if (txt[txt.length - 1] == '') txt.pop();
  ctx.rotate(deg2rad(angle));
  var offsety = (1 - text.justify[1]) / 2 * text.height; // One line offset
  offsety -= (txt.length - 1) * (text.justify[1] + 1) / 2 * interline; // Multiline offset
  for (var i in txt) {
    var lineWidth = text.thickness + interline / 2 * tilt;
    for (var j = 0; j < txt[i].length; j++) {
      if (txt[i][j] == '\t') {
        var fourSpaces = 4 * pcbdata.font_data[' '].w * text.width;
        lineWidth += fourSpaces - lineWidth % fourSpaces;
      } else {
        if (txt[i][j] == '~') {
          j++;
          if (j == txt[i].length)
            break;
        }
        lineWidth += pcbdata.font_data[txt[i][j]].w * text.width;
      }
    }
    var offsetx = -lineWidth * (text.justify[0] + 1) / 2;
    var inOverbar = false;
    for (var j = 0; j < txt[i].length; j++) {
      if (config.kicad_text_formatting) {
        if (txt[i][j] == '\t') {
          var fourSpaces = 4 * pcbdata.font_data[' '].w * text.width;
          offsetx += fourSpaces - offsetx % fourSpaces;
          continue;
        } else if (txt[i][j] == '~') {
          j++;
          if (j == txt[i].length)
            break;
          if (txt[i][j] != '~') {
            inOverbar = !inOverbar;
          }
        }
      }
      var glyph = pcbdata.font_data[txt[i][j]];
      if (inOverbar) {
        var overbarStart = [offsetx, -text.height * 1.4 + offsety];
        var overbarEnd = [offsetx + text.width * glyph.w, overbarStart[1]];

        if (!lastHadOverbar) {
          overbarStart[0] += text.height * 1.4 * tilt;
          lastHadOverbar = true;
        }
        ctx.beginPath();
        ctx.moveTo(...overbarStart);
        ctx.lineTo(...overbarEnd);
        ctx.stroke();
      } else {
        lastHadOverbar = false;
      }
      for (var line of glyph.l) {
        ctx.beginPath();
        ctx.moveTo(...calcFontPoint(line[0], text, offsetx, offsety, tilt));
        for (var k = 1; k < line.length; k++) {
          ctx.lineTo(...calcFontPoint(line[k], text, offsetx, offsety, tilt));
        }
        ctx.stroke();
      }
      offsetx += glyph.w * text.width;
    }
    offsety += interline;
  }
  ctx.restore();
}

function drawedge(ctx, scalefactor, edge, color) {
  ctx.strokeStyle = color;
  ctx.fillStyle = color;
  ctx.lineWidth = Math.max(1 / scalefactor, edge.width);
  ctx.lineCap = "round";
  ctx.lineJoin = "round";
  if ("svgpath" in edge) {
    ctx.stroke(new Path2D(edge.svgpath));
  } else {
    ctx.beginPath();
    if (edge.type == "segment") {
      ctx.moveTo(...edge.start);
      ctx.lineTo(...edge.end);
    }
    if (edge.type == "rect") {
      ctx.moveTo(...edge.start);
      ctx.lineTo(edge.start[0], edge.end[1]);
      ctx.lineTo(...edge.end);
      ctx.lineTo(edge.end[0], edge.start[1]);
      ctx.lineTo(...edge.start);
    }
    if (edge.type == "arc") {
      ctx.arc(
        ...edge.start,
        edge.radius,
        deg2rad(edge.startangle),
        deg2rad(edge.endangle));
    }
    if (edge.type == "circle") {
      ctx.arc(
        ...edge.start,
        edge.radius,
        0, 2 * Math.PI);
      ctx.closePath();
    }
    if (edge.type == "curve") {
      ctx.moveTo(...edge.start);
      ctx.bezierCurveTo(...edge.cpa, ...edge.cpb, ...edge.end);
    }
    if("filled" in edge && edge.filled)
      ctx.fill();
    else
      ctx.stroke();
  }
}

function getChamferedRectPath(size, radius, chamfpos, chamfratio) {
  // chamfpos is a bitmask, left = 1, right = 2, bottom left = 4, bottom right = 8
  var path = new Path2D();
  var width = size[0];
  var height = size[1];
  var x = width * -0.5;
  var y = height * -0.5;
  var chamfOffset = Math.min(width, height) * chamfratio;
  path.moveTo(x, 0);
  if (chamfpos & 4) {
    path.lineTo(x, y + height - chamfOffset);
    path.lineTo(x + chamfOffset, y + height);
    path.lineTo(0, y + height);
  } else {
    path.arcTo(x, y + height, x + width, y + height, radius);
  }
  if (chamfpos & 8) {
    path.lineTo(x + width - chamfOffset, y + height);
    path.lineTo(x + width, y + height - chamfOffset);
    path.lineTo(x + width, 0);
  } else {
    path.arcTo(x + width, y + height, x + width, y, radius);
  }
  if (chamfpos & 2) {
    path.lineTo(x + width, y + chamfOffset);
    path.lineTo(x + width - chamfOffset, y);
    path.lineTo(0, y);
  } else {
    path.arcTo(x + width, y, x, y, radius);
  }
  if (chamfpos & 1) {
    path.lineTo(x + chamfOffset, y);
    path.lineTo(x, y + chamfOffset);
    path.lineTo(x, 0);
  } else {
    path.arcTo(x, y, x, y + height, radius);
  }
  path.closePath();
  return path;
}

function getOblongPath(size) {
  return getChamferedRectPath(size, Math.min(size[0], size[1]) / 2, 0, 0);
}

function getPolygonsPath(shape) {
  if (shape.path2d) {
    return shape.path2d;
  }
  if ("svgpath" in shape) {
    shape.path2d = new Path2D(shape.svgpath);
  } else {
    var path = new Path2D();
    for (var polygon of shape.polygons) {
      path.moveTo(...polygon[0]);
      for (var i = 1; i < polygon.length; i++) {
        path.lineTo(...polygon[i]);
      }
      path.closePath();
    }
    shape.path2d = path;
  }
  return shape.path2d;
}

function drawPolygonShape(ctx, scalefactor, shape, color) {
  ctx.save();
  if (!("svgpath" in shape)) {
    ctx.translate(...shape.pos);
    ctx.rotate(deg2rad(-shape.angle));
  }
  if("filled" in shape && !shape.filled) {
    ctx.strokeStyle = color;
    ctx.lineWidth = Math.max(1 / scalefactor, shape.width);
    ctx.lineCap = "round";
    ctx.lineJoin = "round";
    ctx.stroke(getPolygonsPath(shape));
  } else {
    ctx.fillStyle = color;
    ctx.fill(getPolygonsPath(shape));
  }
  ctx.restore();
}

function drawDrawing(ctx, scalefactor, drawing, color) {
  if (["segment", "arc", "circle", "curve", "rect"].includes(drawing.type)) {
    drawedge(ctx, scalefactor, drawing, color);
  } else if (drawing.type == "polygon") {
    drawPolygonShape(ctx, scalefactor, drawing, color);
  } else {
    drawText(ctx, drawing, color);
  }
}

function getCirclePath(radius) {
  var path = new Path2D();
  path.arc(0, 0, radius, 0, 2 * Math.PI);
  path.closePath();
  return path;
}

function getCachedPadPath(pad) {
  if (!pad.path2d) {
    // if path2d is not set, build one and cache it on pad object
    if (pad.shape == "rect") {
      pad.path2d = new Path2D();
      pad.path2d.rect(...pad.size.map(c => -c * 0.5), ...pad.size);
    } else if (pad.shape == "oval") {
      pad.path2d = getOblongPath(pad.size);
    } else if (pad.shape == "circle") {
      pad.path2d = getCirclePath(pad.size[0] / 2);
    } else if (pad.shape == "roundrect") {
      pad.path2d = getChamferedRectPath(pad.size, pad.radius, 0, 0);
    } else if (pad.shape == "chamfrect") {
      pad.path2d = getChamferedRectPath(pad.size, pad.radius, pad.chamfpos, pad.chamfratio)
    } else if (pad.shape == "custom") {
      pad.path2d = getPolygonsPath(pad);
    }
  }
  return pad.path2d;
}

function drawPad(ctx, pad, color, outline) {
  ctx.save();
  ctx.translate(...pad.pos);
  ctx.rotate(-deg2rad(pad.angle));
  if (pad.offset) {
    ctx.translate(...pad.offset);
  }
  ctx.fillStyle = color;
  ctx.strokeStyle = color;
  var path = getCachedPadPath(pad);
  if (outline) {
    ctx.stroke(path);
  } else {
    ctx.fill(path);
  }
  ctx.restore();
}

function drawPadHole(ctx, pad, padHoleColor) {
  if (pad.type != "th") return;
  ctx.save();
  ctx.translate(...pad.pos);
  ctx.rotate(-deg2rad(pad.angle));
  ctx.fillStyle = padHoleColor;
  if (pad.drillshape == "oblong") {
    ctx.fill(getOblongPath(pad.drillsize));
  } else {
    ctx.fill(getCirclePath(pad.drillsize[0] / 2));
  }
  ctx.restore();
}

function drawFootprint(ctx, layer, scalefactor, footprint, colors, highlight, outline) {
  if (highlight) {
    // draw bounding box
    if (footprint.layer == layer) {
      ctx.save();
      ctx.globalAlpha = 0.2;
      ctx.translate(...footprint.bbox.pos);
      ctx.rotate(deg2rad(-footprint.bbox.angle));
      ctx.translate(...footprint.bbox.relpos);
      ctx.fillStyle = colors.pad;
      ctx.fillRect(0, 0, ...footprint.bbox.size);
      ctx.globalAlpha = 1;
      ctx.strokeStyle = colors.pad;
      ctx.lineWidth = 3 / scalefactor;
      ctx.strokeRect(0, 0, ...footprint.bbox.size);
      ctx.restore();
    }
  }
  // draw drawings
  for (var drawing of footprint.drawings) {
    if (drawing.layer == layer) {
      drawDrawing(ctx, scalefactor, drawing.drawing, colors.pad);
    }
  }
  ctx.lineWidth = 3 / scalefactor;
  // draw pads
  if (settings.renderPads) {
    for (var pad of footprint.pads) {
      if (pad.layers.includes(layer)) {
        drawPad(ctx, pad, colors.pad, outline);
        if (pad.pin1 &&
          (settings.highlightpin1 == "all" ||
            settings.highlightpin1 == "selected" && highlight)) {
          drawPad(ctx, pad, colors.outline, true);
        }
      }
    }
    for (var pad of footprint.pads) {
      drawPadHole(ctx, pad, colors.padHole);
    }
  }
}

function drawEdgeCuts(canvas, scalefactor) {
  var ctx = canvas.getContext("2d");
  var edgecolor = getComputedStyle(topmostdiv).getPropertyValue('--pcb-edge-color');
  for (var edge of pcbdata.edges) {
    drawDrawing(ctx, scalefactor, edge, edgecolor);
  }
}

function drawFootprints(canvas, layer, scalefactor, highlight) {
  var ctx = canvas.getContext("2d");
  ctx.lineWidth = 3 / scalefactor;
  var style = getComputedStyle(topmostdiv);

  var colors = {
    pad: style.getPropertyValue('--pad-color'),
    padHole: style.getPropertyValue('--pad-hole-color'),
    outline: style.getPropertyValue('--pin1-outline-color'),
  }

  for (var i = 0; i < pcbdata.footprints.length; i++) {
    var mod = pcbdata.footprints[i];
    var outline = settings.renderDnpOutline && pcbdata.bom.skipped.includes(i);
    var h = highlightedFootprints.includes(i);
    var d = markedFootprints.has(i);
    if (highlight) {
      if(h && d) {
        colors.pad = style.getPropertyValue('--pad-color-highlight-both');
        colors.outline = style.getPropertyValue('--pin1-outline-color-highlight-both');
      } else if (h) {
        colors.pad = style.getPropertyValue('--pad-color-highlight');
        colors.outline = style.getPropertyValue('--pin1-outline-color-highlight');
      } else if (d) {
        colors.pad = style.getPropertyValue('--pad-color-highlight-marked');
        colors.outline = style.getPropertyValue('--pin1-outline-color-highlight-marked');
      }
    }
    if( h || d || !highlight) {
      drawFootprint(ctx, layer, scalefactor, mod, colors, highlight, outline);
    }
  }
}

function drawBgLayer(layername, canvas, layer, scalefactor, edgeColor, polygonColor, textColor) {
  var ctx = canvas.getContext("2d");
  for (var d of pcbdata.drawings[layername][layer]) {
    if (["segment", "arc", "circle", "curve", "rect"].includes(d.type)) {
      drawedge(ctx, scalefactor, d, edgeColor);
    } else if (d.type == "polygon") {
      drawPolygonShape(ctx, scalefactor, d, polygonColor);
    } else {
      drawText(ctx, d, textColor);
    }
  }
}

function drawTracks(canvas, layer, defaultColor, highlight) {
  ctx = canvas.getContext("2d");
  ctx.lineCap = "round";

  var hasHole = (track) => (
    'drillsize' in track &&
    track.start[0] == track.end[0] &&
    track.start[1] == track.end[1]);

  // First draw tracks and tented vias
  for (var track of pcbdata.tracks[layer]) {
    if (highlight && highlightedNet != track.net) continue;
    if (!hasHole(track)) {
      ctx.strokeStyle = highlight ? defaultColor : settings.netColors[track.net] || defaultColor;
      ctx.lineWidth = track.width;
      ctx.beginPath();
      if ('radius' in track) {
        ctx.arc(
          ...track.center,
          track.radius,
          deg2rad(track.startangle),
          deg2rad(track.endangle));
      } else {
        ctx.moveTo(...track.start);
        ctx.lineTo(...track.end);
      }
      ctx.stroke();
    }
  }
  // Second pass to draw untented vias
  var style = getComputedStyle(topmostdiv);
  var holeColor = style.getPropertyValue('--pad-hole-color')

  for (var track of pcbdata.tracks[layer]) {
    if (highlight && highlightedNet != track.net) continue;
    if (hasHole(track)) {
      ctx.strokeStyle = highlight ? defaultColor : settings.netColors[track.net] || defaultColor;
      ctx.lineWidth = track.width;
      ctx.beginPath();
      ctx.moveTo(...track.start);
      ctx.lineTo(...track.end);
      ctx.stroke();
      ctx.strokeStyle = holeColor;
      ctx.lineWidth = track.drillsize;
      ctx.lineTo(...track.end);
      ctx.stroke();
    }
  }
}

function drawZones(canvas, layer, defaultColor, highlight) {
  ctx = canvas.getContext("2d");
  ctx.lineJoin = "round";
  for (var zone of pcbdata.zones[layer]) {
    if (highlight && highlightedNet != zone.net) continue;
    ctx.strokeStyle = highlight ? defaultColor : settings.netColors[zone.net] || defaultColor;
    ctx.fillStyle = highlight ? defaultColor : settings.netColors[zone.net] || defaultColor;
    if (!zone.path2d) {
      zone.path2d = getPolygonsPath(zone);
    }
    ctx.fill(zone.path2d, zone.fillrule || "nonzero");
    if (zone.width > 0) {
      ctx.lineWidth = zone.width;
      ctx.stroke(zone.path2d);
    }
  }
}

function clearCanvas(canvas, color = null) {
  var ctx = canvas.getContext("2d");
  ctx.save();
  ctx.setTransform(1, 0, 0, 1, 0, 0);
  if (color) {
    ctx.fillStyle = color;
    ctx.fillRect(0, 0, canvas.width, canvas.height);
  } else {
    if (!window.matchMedia("print").matches)
      ctx.clearRect(0, 0, canvas.width, canvas.height);
  }
  ctx.restore();
}

function drawNets(canvas, layer, highlight) {
  var style = getComputedStyle(topmostdiv);
  if (settings.renderZones) {
    var zoneColor = style.getPropertyValue(highlight ? '--zone-color-highlight' : '--zone-color');
    drawZones(canvas, layer, zoneColor, highlight);
  }
  if (settings.renderTracks) {
    var trackColor = style.getPropertyValue(highlight ? '--track-color-highlight' : '--track-color');
    drawTracks(canvas, layer, trackColor, highlight);
  }
  if (highlight && settings.renderPads) {
    var padColor = style.getPropertyValue('--pad-color-highlight');
    var padHoleColor = style.getPropertyValue('--pad-hole-color');
    var ctx = canvas.getContext("2d");
    for (var footprint of pcbdata.footprints) {
      // draw pads
      var padDrawn = false;
      for (var pad of footprint.pads) {
        if (highlightedNet != pad.net) continue;
        if (pad.layers.includes(layer)) {
          drawPad(ctx, pad, padColor, false);
          padDrawn = true;
        }
      }
      if (padDrawn) {
        // redraw all pad holes because some pads may overlap
        for (var pad of footprint.pads) {
          drawPadHole(ctx, pad, padHoleColor);
        }
      }
    }
  }
}

function drawHighlightsOnLayer(canvasdict, clear = true) {
  if (clear) {
    clearCanvas(canvasdict.highlight);
  }
  if (markedFootprints.size > 0 || highlightedFootprints.length > 0) {
    drawFootprints(canvasdict.highlight, canvasdict.layer,
      canvasdict.transform.s * canvasdict.transform.zoom, true);
  }
  if (highlightedNet !== null) {
    drawNets(canvasdict.highlight, canvasdict.layer, true);
  }
}

function drawHighlights() {
  drawHighlightsOnLayer(allcanvas.front);
  drawHighlightsOnLayer(allcanvas.back);
}

function drawBackground(canvasdict, clear = true) {
  if (clear) {
    clearCanvas(canvasdict.bg);
    clearCanvas(canvasdict.fab);
    clearCanvas(canvasdict.silk);
  }

  drawNets(canvasdict.bg, canvasdict.layer, false);
  drawFootprints(canvasdict.bg, canvasdict.layer,
    canvasdict.transform.s * canvasdict.transform.zoom, false);

  drawEdgeCuts(canvasdict.bg, canvasdict.transform.s * canvasdict.transform.zoom);

  var style = getComputedStyle(topmostdiv);
  var edgeColor = style.getPropertyValue('--silkscreen-edge-color');
  var polygonColor = style.getPropertyValue('--silkscreen-polygon-color');
  var textColor = style.getPropertyValue('--silkscreen-text-color');
  if (settings.renderSilkscreen) {
    drawBgLayer(
      "silkscreen", canvasdict.silk, canvasdict.layer,
      canvasdict.transform.s * canvasdict.transform.zoom,
      edgeColor, polygonColor, textColor);
  }
  edgeColor = style.getPropertyValue('--fabrication-edge-color');
  polygonColor = style.getPropertyValue('--fabrication-polygon-color');
  textColor = style.getPropertyValue('--fabrication-text-color');
  if (settings.renderFabrication) {
    drawBgLayer(
      "fabrication", canvasdict.fab, canvasdict.layer,
      canvasdict.transform.s * canvasdict.transform.zoom,
      edgeColor, polygonColor, textColor);
  }
}

function prepareCanvas(canvas, flip, transform) {
  var ctx = canvas.getContext("2d");
  ctx.setTransform(1, 0, 0, 1, 0, 0);
  ctx.scale(transform.zoom, transform.zoom);
  ctx.translate(transform.panx, transform.pany);
  if (flip) {
    ctx.scale(-1, 1);
  }
  ctx.translate(transform.x, transform.y);
  ctx.rotate(deg2rad(settings.boardRotation + (flip && settings.offsetBackRotation ? - 180 : 0)));
  ctx.scale(transform.s, transform.s);
}

function prepareLayer(canvasdict) {
  var flip = (canvasdict.layer === "B");
  for (var c of ["bg", "fab", "silk", "highlight"]) {
    prepareCanvas(canvasdict[c], flip, canvasdict.transform);
  }
}

function rotateVector(v, angle) {
  angle = deg2rad(angle);
  return [
    v[0] * Math.cos(angle) - v[1] * Math.sin(angle),
    v[0] * Math.sin(angle) + v[1] * Math.cos(angle)
  ];
}

function applyRotation(bbox, flip) {
  var corners = [
    [bbox.minx, bbox.miny],
    [bbox.minx, bbox.maxy],
    [bbox.maxx, bbox.miny],
    [bbox.maxx, bbox.maxy],
  ];
  corners = corners.map((v) => rotateVector(v, settings.boardRotation + (flip && settings.offsetBackRotation ? - 180 : 0)));
  return {
    minx: corners.reduce((a, v) => Math.min(a, v[0]), Infinity),
    miny: corners.reduce((a, v) => Math.min(a, v[1]), Infinity),
    maxx: corners.reduce((a, v) => Math.max(a, v[0]), -Infinity),
    maxy: corners.reduce((a, v) => Math.max(a, v[1]), -Infinity),
  }
}

function recalcLayerScale(layerdict, width, height) {
  var flip = (layerdict.layer === "B");
  var bbox = applyRotation(pcbdata.edges_bbox, flip);
  var scalefactor = 0.98 * Math.min(
    width / (bbox.maxx - bbox.minx),
    height / (bbox.maxy - bbox.miny)
  );
  if (scalefactor < 0.1) {
    scalefactor = 1;
  }
  layerdict.transform.s = scalefactor;
  if (flip) {
    layerdict.transform.x = -((bbox.maxx + bbox.minx) * scalefactor + width) * 0.5;
  } else {
    layerdict.transform.x = -((bbox.maxx + bbox.minx) * scalefactor - width) * 0.5;
  }
  layerdict.transform.y = -((bbox.maxy + bbox.miny) * scalefactor - height) * 0.5;
  for (var c of ["bg", "fab", "silk", "highlight"]) {
    canvas = layerdict[c];
    canvas.width = width;
    canvas.height = height;
    canvas.style.width = (width / devicePixelRatio) + "px";
    canvas.style.height = (height / devicePixelRatio) + "px";
  }
}

function redrawCanvas(layerdict) {
  prepareLayer(layerdict);
  drawBackground(layerdict);
  drawHighlightsOnLayer(layerdict);
}

function resizeCanvas(layerdict) {
  var canvasdivid = {
    "F": "frontcanvas",
    "B": "backcanvas"
  } [layerdict.layer];
  var width = document.getElementById(canvasdivid).clientWidth * devicePixelRatio;
  var height = document.getElementById(canvasdivid).clientHeight * devicePixelRatio;
  recalcLayerScale(layerdict, width, height);
  redrawCanvas(layerdict);
}

function resizeAll() {
  resizeCanvas(allcanvas.front);
  resizeCanvas(allcanvas.back);
}

function pointWithinDistanceToSegment(x, y, x1, y1, x2, y2, d) {
  var A = x - x1;
  var B = y - y1;
  var C = x2 - x1;
  var D = y2 - y1;

  var dot = A * C + B * D;
  var len_sq = C * C + D * D;
  var dx, dy;
  if (len_sq == 0) {
    // start and end of the segment coincide
    dx = x - x1;
    dy = y - y1;
  } else {
    var param = dot / len_sq;
    var xx, yy;
    if (param < 0) {
      xx = x1;
      yy = y1;
    } else if (param > 1) {
      xx = x2;
      yy = y2;
    } else {
      xx = x1 + param * C;
      yy = y1 + param * D;
    }
    dx = x - xx;
    dy = y - yy;
  }
  return dx * dx + dy * dy <= d * d;
}

function modulo(n, mod) {
  return ((n % mod) + mod) % mod;
}

function pointWithinDistanceToArc(x, y, xc, yc, radius, startangle, endangle, d) {
  var dx = x - xc;
  var dy = y - yc;
  var r_sq = dx * dx + dy * dy;
  var rmin = Math.max(0, radius - d);
  var rmax = radius + d;

  if (r_sq < rmin * rmin || r_sq > rmax * rmax)
    return false;

  var angle1 = modulo(deg2rad(startangle), 2 * Math.PI);
  var dx1 = xc + radius * Math.cos(angle1) - x;
  var dy1 = yc + radius * Math.sin(angle1) - y;
  if (dx1 * dx1 + dy1 * dy1 <= d * d)
    return true;

  var angle2 = modulo(deg2rad(endangle), 2 * Math.PI);
  var dx2 = xc + radius * Math.cos(angle2) - x;
  var dy2 = yc + radius * Math.sin(angle2) - y;
  if (dx2 * dx2 + dy2 * dy2 <= d * d)
    return true;

  var angle = modulo(Math.atan2(dy, dx), 2 * Math.PI);
  if (angle1 > angle2)
    return (angle >= angle2 || angle <= angle1);
  else
    return (angle >= angle1 && angle <= angle2);
}

function pointWithinPad(x, y, pad) {
  var v = [x - pad.pos[0], y - pad.pos[1]];
  v = rotateVector(v, pad.angle);
  if (pad.offset) {
    v[0] -= pad.offset[0];
    v[1] -= pad.offset[1];
  }
  return emptyContext2d.isPointInPath(getCachedPadPath(pad), ...v);
}

function netHitScan(layer, x, y) {
  // Check track segments
  if (settings.renderTracks && pcbdata.tracks) {
    for (var track of pcbdata.tracks[layer]) {
      if ('radius' in track) {
        if (pointWithinDistanceToArc(x, y, ...track.center, track.radius, track.startangle, track.endangle, track.width / 2)) {
          return track.net;
        }
      } else {
        if (pointWithinDistanceToSegment(x, y, ...track.start, ...track.end, track.width / 2)) {
          return track.net;
        }
      }
    }
  }
  // Check pads
  if (settings.renderPads) {
    for (var footprint of pcbdata.footprints) {
      for (var pad of footprint.pads) {
        if (pad.layers.includes(layer) && pointWithinPad(x, y, pad)) {
          return pad.net;
        }
      }
    }
  }
  return null;
}

function pointWithinFootprintBbox(x, y, bbox) {
  var v = [x - bbox.pos[0], y - bbox.pos[1]];
  v = rotateVector(v, bbox.angle);
  return bbox.relpos[0] <= v[0] && v[0] <= bbox.relpos[0] + bbox.size[0] &&
    bbox.relpos[1] <= v[1] && v[1] <= bbox.relpos[1] + bbox.size[1];
}

function bboxHitScan(layer, x, y) {
  var result = [];
  for (var i = 0; i < pcbdata.footprints.length; i++) {
    var footprint = pcbdata.footprints[i];
    if (footprint.layer == layer) {
      if (pointWithinFootprintBbox(x, y, footprint.bbox)) {
        result.push(i);
      }
    }
  }
  return result;
}

function handlePointerDown(e, layerdict) {
  if (e.button != 0 && e.button != 1) {
    return;
  }
  e.preventDefault();
  e.stopPropagation();

  if (!e.hasOwnProperty("offsetX")) {
    // The polyfill doesn't set this properly
    e.offsetX = e.pageX - e.currentTarget.offsetLeft;
    e.offsetY = e.pageY - e.currentTarget.offsetTop;
  }

  layerdict.pointerStates[e.pointerId] = {
    distanceTravelled: 0,
    lastX: e.offsetX,
    lastY: e.offsetY,
    downTime: Date.now(),
  };
}

function handleMouseClick(e, layerdict) {
  if (!e.hasOwnProperty("offsetX")) {
    // The polyfill doesn't set this properly
    e.offsetX = e.pageX - e.currentTarget.offsetLeft;
    e.offsetY = e.pageY - e.currentTarget.offsetTop;
  }

  var x = e.offsetX;
  var y = e.offsetY;
  var t = layerdict.transform;
  var flip = layerdict.layer === "B";
  if (flip) {
    x = (devicePixelRatio * x / t.zoom - t.panx + t.x) / -t.s;
  } else {
    x = (devicePixelRatio * x / t.zoom - t.panx - t.x) / t.s;
  }
  y = (devicePixelRatio * y / t.zoom - t.y - t.pany) / t.s;
  var v = rotateVector([x, y], -settings.boardRotation + (flip && settings.offsetBackRotation ? - 180 : 0));
  if ("nets" in pcbdata) {
    var net = netHitScan(layerdict.layer, ...v);
    if (net !== highlightedNet) {
      netClicked(net);
    }
  }
  if (highlightedNet === null) {
    var footprints = bboxHitScan(layerdict.layer, ...v);
    if (footprints.length > 0) {
      footprintsClicked(footprints);
    }
  }
}

function handlePointerLeave(e, layerdict) {
  e.preventDefault();
  e.stopPropagation();

  if (!settings.redrawOnDrag) {
    redrawCanvas(layerdict);
  }

  delete layerdict.pointerStates[e.pointerId];
}

function resetTransform(layerdict) {
  layerdict.transform.panx = 0;
  layerdict.transform.pany = 0;
  layerdict.transform.zoom = 1;
  redrawCanvas(layerdict);
}

function handlePointerUp(e, layerdict) {
  if (!e.hasOwnProperty("offsetX")) {
    // The polyfill doesn't set this properly
    e.offsetX = e.pageX - e.currentTarget.offsetLeft;
    e.offsetY = e.pageY - e.currentTarget.offsetTop;
  }

  e.preventDefault();
  e.stopPropagation();

  if (e.button == 2) {
    // Reset pan and zoom on right click.
    resetTransform(layerdict);
    layerdict.anotherPointerTapped = false;
    return;
  }

  // We haven't necessarily had a pointermove event since the interaction started, so make sure we update this now
  var ptr = layerdict.pointerStates[e.pointerId];
  ptr.distanceTravelled += Math.abs(e.offsetX - ptr.lastX) + Math.abs(e.offsetY - ptr.lastY);

  if (e.button == 0 && ptr.distanceTravelled < 10 && Date.now() - ptr.downTime <= 500) {
    if (Object.keys(layerdict.pointerStates).length == 1) {
      if (layerdict.anotherPointerTapped) {
        // This is the second pointer coming off of a two-finger tap
        resetTransform(layerdict);
      } else {
        // This is just a regular tap
        handleMouseClick(e, layerdict);
      }
      layerdict.anotherPointerTapped = false;
    } else {
      // This is the first finger coming off of what could become a two-finger tap
      layerdict.anotherPointerTapped = true;
    }
  } else {
    if (!settings.redrawOnDrag) {
      redrawCanvas(layerdict);
    }
    layerdict.anotherPointerTapped = false;
  }

  delete layerdict.pointerStates[e.pointerId];
}

function handlePointerMove(e, layerdict) {
  if (!layerdict.pointerStates.hasOwnProperty(e.pointerId)) {
    return;
  }
  e.preventDefault();
  e.stopPropagation();

  if (!e.hasOwnProperty("offsetX")) {
    // The polyfill doesn't set this properly
    e.offsetX = e.pageX - e.currentTarget.offsetLeft;
    e.offsetY = e.pageY - e.currentTarget.offsetTop;
  }

  var thisPtr = layerdict.pointerStates[e.pointerId];

  var dx = e.offsetX - thisPtr.lastX;
  var dy = e.offsetY - thisPtr.lastY;

  // If this number is low on pointer up, we count the action as a click
  thisPtr.distanceTravelled += Math.abs(dx) + Math.abs(dy);

  if (Object.keys(layerdict.pointerStates).length == 1) {
    // This is a simple drag
    layerdict.transform.panx += devicePixelRatio * dx / layerdict.transform.zoom;
    layerdict.transform.pany += devicePixelRatio * dy / layerdict.transform.zoom;
  } else if (Object.keys(layerdict.pointerStates).length == 2) {
    var otherPtr = Object.values(layerdict.pointerStates).filter((ptr) => ptr != thisPtr)[0];

    var oldDist = Math.sqrt(Math.pow(thisPtr.lastX - otherPtr.lastX, 2) + Math.pow(thisPtr.lastY - otherPtr.lastY, 2));
    var newDist = Math.sqrt(Math.pow(e.offsetX - otherPtr.lastX, 2) + Math.pow(e.offsetY - otherPtr.lastY, 2));

    var scaleFactor = newDist / oldDist;

    if (scaleFactor != NaN) {
      layerdict.transform.zoom *= scaleFactor;

      var zoomd = (1 - scaleFactor) / layerdict.transform.zoom;
      layerdict.transform.panx += devicePixelRatio * otherPtr.lastX * zoomd;
      layerdict.transform.pany += devicePixelRatio * otherPtr.lastY * zoomd;
    }
  }

  thisPtr.lastX = e.offsetX;
  thisPtr.lastY = e.offsetY;

  if (settings.redrawOnDrag) {
    redrawCanvas(layerdict);
  }
}

function handleMouseWheel(e, layerdict) {
  e.preventDefault();
  e.stopPropagation();
  var t = layerdict.transform;
  var wheeldelta = e.deltaY;
  if (e.deltaMode == 1) {
    // FF only, scroll by lines
    wheeldelta *= 30;
  } else if (e.deltaMode == 2) {
    wheeldelta *= 300;
  }
  var m = Math.pow(1.1, -wheeldelta / 40);
  // Limit amount of zoom per tick.
  if (m > 2) {
    m = 2;
  } else if (m < 0.5) {
    m = 0.5;
  }
  t.zoom *= m;
  var zoomd = (1 - m) / t.zoom;
  t.panx += devicePixelRatio * e.offsetX * zoomd;
  t.pany += devicePixelRatio * e.offsetY * zoomd;
  redrawCanvas(layerdict);
}

function addMouseHandlers(div, layerdict) {
  div.addEventListener("pointerdown", function(e) {
    handlePointerDown(e, layerdict);
  });
  div.addEventListener("pointermove", function(e) {
    handlePointerMove(e, layerdict);
  });
  div.addEventListener("pointerup", function(e) {
    handlePointerUp(e, layerdict);
  });
  var pointerleave = function(e) {
    handlePointerLeave(e, layerdict);
  }
  div.addEventListener("pointercancel", pointerleave);
  div.addEventListener("pointerleave", pointerleave);
  div.addEventListener("pointerout", pointerleave);

  div.onwheel = function(e) {
    handleMouseWheel(e, layerdict);
  }
  for (var element of [div, layerdict.bg, layerdict.fab, layerdict.silk, layerdict.highlight]) {
    element.addEventListener("contextmenu", function(e) {
      e.preventDefault();
    }, false);
  }
}

function setRedrawOnDrag(value) {
  settings.redrawOnDrag = value;
  writeStorage("redrawOnDrag", value);
}

function setBoardRotation(value) {
  settings.boardRotation = value * 5;
  writeStorage("boardRotation", settings.boardRotation);
  document.getElementById("rotationDegree").textContent = settings.boardRotation;
  resizeAll();
}

function setOffsetBackRotation(value) {
  settings.offsetBackRotation = value;
  writeStorage("offsetBackRotation", value);
  resizeAll();
}

function initRender() {
  allcanvas = {
    front: {
      transform: {
        x: 0,
        y: 0,
        s: 1,
        panx: 0,
        pany: 0,
        zoom: 1,
      },
      pointerStates: {},
      anotherPointerTapped: false,
      bg: document.getElementById("F_bg"),
      fab: document.getElementById("F_fab"),
      silk: document.getElementById("F_slk"),
      highlight: document.getElementById("F_hl"),
      layer: "F",
    },
    back: {
      transform: {
        x: 0,
        y: 0,
        s: 1,
        panx: 0,
        pany: 0,
        zoom: 1,
      },
      pointerStates: {},
      anotherPointerTapped: false,
      bg: document.getElementById("B_bg"),
      fab: document.getElementById("B_fab"),
      silk: document.getElementById("B_slk"),
      highlight: document.getElementById("B_hl"),
      layer: "B",
    }
  };
  addMouseHandlers(document.getElementById("frontcanvas"), allcanvas.front);
  addMouseHandlers(document.getElementById("backcanvas"), allcanvas.back);
}

///////////////////////////////////////////////

///////////////////////////////////////////////
/*
 * Table reordering via Drag'n'Drop
 * Inspired by: https://htmldom.dev/drag-and-drop-table-column
 */

function setBomHandlers() {

  const bom = document.getElementById('bomtable');

  let dragName;
  let placeHolderElements;
  let draggingElement;
  let forcePopulation;
  let xOffset;
  let yOffset;
  let wasDragged;

  const mouseUpHandler = function(e) {
    // Delete dragging element
    draggingElement.remove();

    // Make BOM selectable again
    bom.style.removeProperty("userSelect");

    // Remove listeners
    document.removeEventListener('mousemove', mouseMoveHandler);
    document.removeEventListener('mouseup', mouseUpHandler);

    if (wasDragged) {
      // Redraw whole BOM
      populateBomTable();
    }
  }

  const mouseMoveHandler = function(e) {
    // Notice the dragging
    wasDragged = true;

    // Make the dragged element visible
    draggingElement.style.removeProperty("display");

    // Set elements position to mouse position
    draggingElement.style.left = `${e.screenX - xOffset}px`;
    draggingElement.style.top = `${e.screenY - yOffset}px`;

    // Forced redrawing of BOM table
    if (forcePopulation) {
      forcePopulation = false;
      // Copy array
      phe = Array.from(placeHolderElements);
      // populate BOM table again
      populateBomHeader(dragName, phe);
      populateBomBody(dragName, phe);
    }

    // Set up array of hidden columns
    var hiddenColumns = Array.from(settings.hiddenColumns);
    // In the ungrouped mode, quantity don't exist
    if (settings.bommode === "ungrouped")
      hiddenColumns.push("Quantity");
    // If no checkbox fields can be found, we consider them hidden
    if (settings.checkboxes.length == 0)
      hiddenColumns.push("checkboxes");

    // Get table headers and group them into checkboxes, extrafields and normal headers
    const bh = document.getElementById("bomhead");
    headers = Array.from(bh.querySelectorAll("th"))
    headers.shift() // numCol is not part of the columnOrder
    headerGroups = []
    lastCompoundClass = null;
    for (i = 0; i < settings.columnOrder.length; i++) {
      cElem = settings.columnOrder[i];
      if (hiddenColumns.includes(cElem)) {
        // Hidden columns appear as a dummy element
        headerGroups.push([]);
        continue;
      }
      elem = headers.filter(e => getColumnOrderName(e) === cElem)[0];
      if (elem.classList.contains("bom-checkbox")) {
        if (lastCompoundClass === "bom-checkbox") {
          cbGroup = headerGroups.pop();
          cbGroup.push(elem);
          headerGroups.push(cbGroup);
        } else {
          lastCompoundClass = "bom-checkbox";
          headerGroups.push([elem])
        }
      } else {
        headerGroups.push([elem])
      }
    }

    // Copy settings.columnOrder
    var columns = Array.from(settings.columnOrder)

    // Set up array with indices of hidden columns
    var hiddenIndices = hiddenColumns.map(e => settings.columnOrder.indexOf(e));
    var dragIndex = columns.indexOf(dragName);
    var swapIndex = dragIndex;
    var swapDone = false;

    // Check if the current dragged element is swapable with the left or right element
    if (dragIndex > 0) {
      // Get left headers boundingbox
      swapIndex = dragIndex - 1;
      while (hiddenIndices.includes(swapIndex) && swapIndex > 0)
        swapIndex--;
      if (!hiddenIndices.includes(swapIndex)) {
        box = getBoundingClientRectFromMultiple(headerGroups[swapIndex]);
        if (e.clientX < box.left + window.scrollX + (box.width / 2)) {
          swapElement = columns[dragIndex];
          columns.splice(dragIndex, 1);
          columns.splice(swapIndex, 0, swapElement);
          forcePopulation = true;
          swapDone = true;
        }
      }
    }
    if ((!swapDone) && dragIndex < headerGroups.length - 1) {
      // Get right headers boundingbox
      swapIndex = dragIndex + 1;
      while (hiddenIndices.includes(swapIndex))
        swapIndex++;
      if (swapIndex < headerGroups.length) {
        box = getBoundingClientRectFromMultiple(headerGroups[swapIndex]);
        if (e.clientX > box.left + window.scrollX + (box.width / 2)) {
          swapElement = columns[dragIndex];
          columns.splice(dragIndex, 1);
          columns.splice(swapIndex, 0, swapElement);
          forcePopulation = true;
          swapDone = true;
        }
      }
    }

    // Write back change to storage
    if (swapDone) {
      settings.columnOrder = columns
      writeStorage("columnOrder", JSON.stringify(columns));
    }

  }

  const mouseDownHandler = function(e) {
    var target = e.target;
    if (target.tagName.toLowerCase() != "td")
      target = target.parentElement;

    // Used to check if a dragging has ever happened
    wasDragged = false;

    // Create new element which will be displayed as the dragged column
    draggingElement = document.createElement("div")
    draggingElement.classList.add("dragging");
    draggingElement.style.display = "none";
    draggingElement.style.position = "absolute";
    draggingElement.style.overflow = "hidden";

    // Get bomhead and bombody elements
    const bh = document.getElementById("bomhead");
    const bb = document.getElementById("bombody");

    // Get all compound headers for the current column
    var compoundHeaders;
    if (target.classList.contains("bom-checkbox")) {
      compoundHeaders = Array.from(bh.querySelectorAll("th.bom-checkbox"));
    } else {
      compoundHeaders = [target];
    }

    // Create new table which will display the column
    var newTable = document.createElement("table");
    newTable.classList.add("bom");
    newTable.style.background = "white";
    draggingElement.append(newTable);

    // Create new header element
    var newHeader = document.createElement("thead");
    newTable.append(newHeader);

    // Set up array for storing all placeholder elements
    placeHolderElements = [];

    // Add all compound headers to the new thead element and placeholders
    compoundHeaders.forEach(function(h) {
      clone = cloneElementWithDimensions(h);
      newHeader.append(clone);
      placeHolderElements.push(clone);
    });

    // Create new body element
    var newBody = document.createElement("tbody");
    newTable.append(newBody);

    // Get indices for compound headers
    var idxs = compoundHeaders.map(e => getBomTableHeaderIndex(e));

    // For each row in the BOM body...
    var rows = bb.querySelectorAll("tr");
    rows.forEach(function(row) {
      // ..get the cells for the compound column
      const tds = row.querySelectorAll("td");
      var copytds = idxs.map(i => tds[i]);
      // Add them to the new element and the placeholders
      var newRow = document.createElement("tr");
      copytds.forEach(function(td) {
        clone = cloneElementWithDimensions(td);
        newRow.append(clone);
        placeHolderElements.push(clone);
      });
      newBody.append(newRow);
    });

    // Compute width for compound header
    var width = compoundHeaders.reduce((acc, x) => acc + x.clientWidth, 0);
    draggingElement.style.width = `${width}px`;

    // Insert the new dragging element and disable selection on BOM
    bom.insertBefore(draggingElement, null);
    bom.style.userSelect = "none";

    // Determine the mouse position offset
    xOffset = e.screenX - compoundHeaders.reduce((acc, x) => Math.min(acc, x.offsetLeft), compoundHeaders[0].offsetLeft);
    yOffset = e.screenY - compoundHeaders[0].offsetTop;

    // Get name for the column in settings.columnOrder
    dragName = getColumnOrderName(target);

    // Change text and class for placeholder elements
    placeHolderElements = placeHolderElements.map(function(e) {
      newElem = cloneElementWithDimensions(e);
      newElem.textContent = "";
      newElem.classList.add("placeholder");
      return newElem;
    });

    // On next mouse move, the whole BOM needs to be redrawn to show the placeholders
    forcePopulation = true;

    // Add listeners for move and up on mouse
    document.addEventListener('mousemove', mouseMoveHandler);
    document.addEventListener('mouseup', mouseUpHandler);
  }

  // In netlist mode, there is nothing to reorder
  if (settings.bommode === "netlist")
    return;

  // Add mouseDownHandler to every column except the numCol
  bom.querySelectorAll("th")
    .forEach(function(head) {
      if (!head.classList.contains("numCol")) {
        head.onmousedown = mouseDownHandler;
      }
    });

}

function getBoundingClientRectFromMultiple(elements) {
  var elems = Array.from(elements);

  if (elems.length == 0)
    return null;

  var box = elems.shift()
    .getBoundingClientRect();

  elems.forEach(function(elem) {
    var elembox = elem.getBoundingClientRect();
    box.left = Math.min(elembox.left, box.left);
    box.top = Math.min(elembox.top, box.top);
    box.width += elembox.width;
    box.height = Math.max(elembox.height, box.height);
  });

  return box;
}

function cloneElementWithDimensions(elem) {
  var newElem = elem.cloneNode(true);
  newElem.style.height = window.getComputedStyle(elem).height;
  newElem.style.width = window.getComputedStyle(elem).width;
  return newElem;
}

function getBomTableHeaderIndex(elem) {
  const bh = document.getElementById('bomhead');
  const ths = Array.from(bh.querySelectorAll("th"));
  return ths.indexOf(elem);
}

function getColumnOrderName(elem) {
  var cname = elem.getAttribute("col_name");
  if (cname === "bom-checkbox")
    return "checkboxes";
  else
    return cname;
}

function resizableGrid(tablehead) {
  var cols = tablehead.firstElementChild.children;
  var rowWidth = tablehead.offsetWidth;

  for (var i = 1; i < cols.length; i++) {
    if (cols[i].classList.contains("bom-checkbox"))
      continue;
    cols[i].style.width = ((cols[i].clientWidth - paddingDiff(cols[i])) * 100 / rowWidth) + '%';
  }

  for (var i = 1; i < cols.length - 1; i++) {
    var div = document.createElement('div');
    div.className = "column-width-handle";
    cols[i].appendChild(div);
    setListeners(div);
  }

  function setListeners(div) {
    var startX, curCol, nxtCol, curColWidth, nxtColWidth, rowWidth;

    div.addEventListener('mousedown', function(e) {
      e.preventDefault();
      e.stopPropagation();

      curCol = e.target.parentElement;
      nxtCol = curCol.nextElementSibling;
      startX = e.pageX;

      var padding = paddingDiff(curCol);

      rowWidth = curCol.parentElement.offsetWidth;
      curColWidth = curCol.clientWidth - padding;
      nxtColWidth = nxtCol.clientWidth - padding;
    });

    document.addEventListener('mousemove', function(e) {
      if (startX) {
        var diffX = e.pageX - startX;
        diffX = -Math.min(-diffX, curColWidth - 20);
        diffX = Math.min(diffX, nxtColWidth - 20);

        curCol.style.width = ((curColWidth + diffX) * 100 / rowWidth) + '%';
        nxtCol.style.width = ((nxtColWidth - diffX) * 100 / rowWidth) + '%';
        console.log(`${curColWidth + nxtColWidth} ${(curColWidth + diffX) * 100 / rowWidth + (nxtColWidth - diffX) * 100 / rowWidth}`);
      }
    });

    document.addEventListener('mouseup', function(e) {
      curCol = undefined;
      nxtCol = undefined;
      startX = undefined;
      nxtColWidth = undefined;
      curColWidth = undefined
    });
  }

  function paddingDiff(col) {

    if (getStyleVal(col, 'box-sizing') == 'border-box') {
      return 0;
    }

    var padLeft = getStyleVal(col, 'padding-left');
    var padRight = getStyleVal(col, 'padding-right');
    return (parseInt(padLeft) + parseInt(padRight));

  }

  function getStyleVal(elm, css) {
    return (window.getComputedStyle(elm, null).getPropertyValue(css))
  }
}

///////////////////////////////////////////////

///////////////////////////////////////////////
/* DOM manipulation and misc code */

var bomsplit;
var canvassplit;
var initDone = false;
var bomSortFunction = null;
var currentSortColumn = null;
var currentSortOrder = null;
var currentHighlightedRowId;
var highlightHandlers = [];
var footprintIndexToHandler = {};
var netsToHandler = {};
var markedFootprints = new Set();
var highlightedFootprints = [];
var highlightedNet = null;
var lastClicked;

function dbg(html) {
  dbgdiv.innerHTML = html;
}

function redrawIfInitDone() {
  if (initDone) {
    redrawCanvas(allcanvas.front);
    redrawCanvas(allcanvas.back);
  }
}

function padsVisible(value) {
  writeStorage("padsVisible", value);
  settings.renderPads = value;
  redrawIfInitDone();
}

function referencesVisible(value) {
  writeStorage("referencesVisible", value);
  settings.renderReferences = value;
  redrawIfInitDone();
}

function valuesVisible(value) {
  writeStorage("valuesVisible", value);
  settings.renderValues = value;
  redrawIfInitDone();
}

function tracksVisible(value) {
  writeStorage("tracksVisible", value);
  settings.renderTracks = value;
  redrawIfInitDone();
}

function zonesVisible(value) {
  writeStorage("zonesVisible", value);
  settings.renderZones = value;
  redrawIfInitDone();
}

function dnpOutline(value) {
  writeStorage("dnpOutline", value);
  settings.renderDnpOutline = value;
  redrawIfInitDone();
}

function setDarkMode(value) {
  if (value) {
    topmostdiv.classList.add("dark");
  } else {
    topmostdiv.classList.remove("dark");
  }
  writeStorage("darkmode", value);
  settings.darkMode = value;
  redrawIfInitDone();
  if (initDone) {
    populateBomTable();
  }
}

function setShowBOMColumn(field, value) {
  if (field === "references") {
    var rl = document.getElementById("reflookup");
    rl.disabled = !value;
    if (!value) {
      rl.value = "";
      updateRefLookup("");
    }
  }

  var n = settings.hiddenColumns.indexOf(field);
  if (value) {
    if (n != -1) {
      settings.hiddenColumns.splice(n, 1);
    }
  } else {
    if (n == -1) {
      settings.hiddenColumns.push(field);
    }
  }

  writeStorage("hiddenColumns", JSON.stringify(settings.hiddenColumns));

  if (initDone) {
    populateBomTable();
  }

  redrawIfInitDone();
}


function setFullscreen(value) {
  if (value) {
    document.documentElement.requestFullscreen();
  } else {
    document.exitFullscreen();
  }
}

function fabricationVisible(value) {
  writeStorage("fabricationVisible", value);
  settings.renderFabrication = value;
  redrawIfInitDone();
}

function silkscreenVisible(value) {
  writeStorage("silkscreenVisible", value);
  settings.renderSilkscreen = value;
  redrawIfInitDone();
}

function setHighlightPin1(value) {
  writeStorage("highlightpin1", value);
  settings.highlightpin1 = value;
  redrawIfInitDone();
}

function getStoredCheckboxRefs(checkbox) {
  function convert(ref) {
    var intref = parseInt(ref);
    if (isNaN(intref)) {
      for (var i = 0; i < pcbdata.footprints.length; i++) {
        if (pcbdata.footprints[i].ref == ref) {
          return i;
        }
      }
      return -1;
    } else {
      return intref;
    }
  }
  if (!(checkbox in settings.checkboxStoredRefs)) {
    var val = readStorage("checkbox_" + checkbox);
    settings.checkboxStoredRefs[checkbox] = val ? val : "";
  }
  if (!settings.checkboxStoredRefs[checkbox]) {
    return new Set();
  } else {
    return new Set(settings.checkboxStoredRefs[checkbox].split(",").map(r => convert(r)).filter(a => a >= 0));
  }
}

function getCheckboxState(checkbox, references) {
  var storedRefsSet = getStoredCheckboxRefs(checkbox);
  var currentRefsSet = new Set(references.map(r => r[1]));
  // Get difference of current - stored
  var difference = new Set(currentRefsSet);
  for (ref of storedRefsSet) {
    difference.delete(ref);
  }
  if (difference.size == 0) {
    // All the current refs are stored
    return "checked";
  } else if (difference.size == currentRefsSet.size) {
    // None of the current refs are stored
    return "unchecked";
  } else {
    // Some of the refs are stored
    return "indeterminate";
  }
}

function setBomCheckboxState(checkbox, element, references) {
  var state = getCheckboxState(checkbox, references);
  element.checked = (state == "checked");
  element.indeterminate = (state == "indeterminate");
}

function createCheckboxChangeHandler(checkbox, references, row) {
  return function () {
    refsSet = getStoredCheckboxRefs(checkbox);
    var markWhenChecked = settings.markWhenChecked == checkbox;
    eventArgs = {
      checkbox: checkbox,
      refs: references,
    }
    if (this.checked) {
      // checkbox ticked
      for (var ref of references) {
        refsSet.add(ref[1]);
      }
      if (markWhenChecked) {
        row.classList.add("checked");
        for (var ref of references) {
          markedFootprints.add(ref[1]);
        }
        drawHighlights();
      }
      eventArgs.state = 'checked';
    } else {
      // checkbox unticked
      for (var ref of references) {
        refsSet.delete(ref[1]);
      }
      if (markWhenChecked) {
        row.classList.remove("checked");
        for (var ref of references) {
          markedFootprints.delete(ref[1]);
        }
        drawHighlights();
      }
      eventArgs.state = 'unchecked';
    }
    settings.checkboxStoredRefs[checkbox] = [...refsSet].join(",");
    writeStorage("checkbox_" + checkbox, settings.checkboxStoredRefs[checkbox]);
    updateCheckboxStats(checkbox);
    EventHandler.emitEvent(IBOM_EVENT_TYPES.CHECKBOX_CHANGE_EVENT, eventArgs);
  }
}

function clearHighlightedFootprints() {
  if (currentHighlightedRowId) {
    document.getElementById(currentHighlightedRowId).classList.remove("highlighted");
    currentHighlightedRowId = null;
    highlightedFootprints = [];
    highlightedNet = null;
  }
}

function createRowHighlightHandler(rowid, refs, net) {
  return function () {
    if (currentHighlightedRowId) {
      if (currentHighlightedRowId == rowid) {
        return;
      }
      document.getElementById(currentHighlightedRowId).classList.remove("highlighted");
    }
    document.getElementById(rowid).classList.add("highlighted");
    currentHighlightedRowId = rowid;
    highlightedFootprints = refs ? refs.map(r => r[1]) : [];
    highlightedNet = net;
    drawHighlights();
    EventHandler.emitEvent(
      IBOM_EVENT_TYPES.HIGHLIGHT_EVENT, {
      rowid: rowid,
      refs: refs,
      net: net
    });
  }
}

function updateNetColors() {
  writeStorage("netColors", JSON.stringify(settings.netColors));
  redrawIfInitDone();
}

function netColorChangeHandler(net) {
  return (event) => {
    settings.netColors[net] = event.target.value;
    updateNetColors();
  }
}

function netColorRightClick(net) {
  return (event) => {
    if(event.button == 2) {
      event.preventDefault();
      event.stopPropagation();

      var style = getComputedStyle(topmostdiv);
      var defaultNetColor = style.getPropertyValue('--track-color').trim();
      event.target.value = defaultNetColor;
      delete settings.netColors[net];
      updateNetColors();
    }
  }
}

function entryMatches(entry) {
  if (settings.bommode == "netlist") {
    // entry is just a net name
    return entry.toLowerCase().indexOf(filter) >= 0;
  }
  // check refs
  if (!settings.hiddenColumns.includes("references")) {
    for (var ref of entry) {
      if (ref[0].toLowerCase().indexOf(filter) >= 0) {
        return true;
      }
    }
  }
  // check fields
  for (var i in config.fields) {
    var f = config.fields[i];
    if (!settings.hiddenColumns.includes(f)) {
      for (var ref of entry) {
        if (String(pcbdata.bom.fields[ref[1]][i]).toLowerCase().indexOf(filter) >= 0) {
          return true;
        }
      }
    }
  }
  return false;
}

function findRefInEntry(entry) {
  return entry.filter(r => r[0].toLowerCase() == reflookup);
}

function highlightFilter(s) {
  if (!filter) {
    return s;
  }
  var parts = s.toLowerCase().split(filter);
  if (parts.length == 1) {
    return s;
  }
  var r = "";
  var pos = 0;
  for (var i in parts) {
    if (i > 0) {
      r += '<mark class="highlight">' +
        s.substring(pos, pos + filter.length) +
        '</mark>';
      pos += filter.length;
    }
    r += s.substring(pos, pos + parts[i].length);
    pos += parts[i].length;
  }
  return r;
}

function checkboxSetUnsetAllHandler(checkboxname) {
  return function () {
    var checkboxnum = 0;
    while (checkboxnum < settings.checkboxes.length &&
      settings.checkboxes[checkboxnum].toLowerCase() != checkboxname.toLowerCase()) {
      checkboxnum++;
    }
    if (checkboxnum >= settings.checkboxes.length) {
      return;
    }
    var allset = true;
    var checkbox;
    var row;
    for (row of bombody.childNodes) {
      checkbox = row.childNodes[checkboxnum + 1].childNodes[0];
      if (!checkbox.checked || checkbox.indeterminate) {
        allset = false;
        break;
      }
    }
    for (row of bombody.childNodes) {
      checkbox = row.childNodes[checkboxnum + 1].childNodes[0];
      checkbox.checked = !allset;
      checkbox.indeterminate = false;
      checkbox.onchange();
    }
  }
}

function createColumnHeader(name, cls, comparator, is_checkbox = false) {
  var th = document.createElement("TH");
  th.innerHTML = name;
  th.classList.add(cls);
  if (is_checkbox)
    th.setAttribute("col_name", "bom-checkbox");
  else
    th.setAttribute("col_name", name);
  var span = document.createElement("SPAN");
  span.classList.add("sortmark");
  span.classList.add("none");
  th.appendChild(span);
  var spacer = document.createElement("div");
  spacer.className = "column-spacer";
  th.appendChild(spacer);
  spacer.onclick = function () {
    if (currentSortColumn && th !== currentSortColumn) {
      // Currently sorted by another column
      currentSortColumn.childNodes[1].classList.remove(currentSortOrder);
      currentSortColumn.childNodes[1].classList.add("none");
      currentSortColumn = null;
      currentSortOrder = null;
    }
    if (currentSortColumn && th === currentSortColumn) {
      // Already sorted by this column
      if (currentSortOrder == "asc") {
        // Sort by this column, descending order
        bomSortFunction = function (a, b) {
          return -comparator(a, b);
        }
        currentSortColumn.childNodes[1].classList.remove("asc");
        currentSortColumn.childNodes[1].classList.add("desc");
        currentSortOrder = "desc";
      } else {
        // Unsort
        bomSortFunction = null;
        currentSortColumn.childNodes[1].classList.remove("desc");
        currentSortColumn.childNodes[1].classList.add("none");
        currentSortColumn = null;
        currentSortOrder = null;
      }
    } else {
      // Sort by this column, ascending order
      bomSortFunction = comparator;
      currentSortColumn = th;
      currentSortColumn.childNodes[1].classList.remove("none");
      currentSortColumn.childNodes[1].classList.add("asc");
      currentSortOrder = "asc";
    }
    populateBomBody();
  }
  if (is_checkbox) {
    spacer.onclick = fancyDblClickHandler(
      spacer, spacer.onclick, checkboxSetUnsetAllHandler(name));
  }
  return th;
}

function populateBomHeader(placeHolderColumn = null, placeHolderElements = null) {
  while (bomhead.firstChild) {
    bomhead.removeChild(bomhead.firstChild);
  }
  var tr = document.createElement("TR");
  var th = document.createElement("TH");
  th.classList.add("numCol");

  var vismenu = document.createElement("div");
  vismenu.id = "vismenu";
  vismenu.classList.add("menu");

  var visbutton = document.createElement("div");
  visbutton.classList.add("visbtn");
  visbutton.classList.add("hideonprint");

  var viscontent = document.createElement("div");
  viscontent.classList.add("menu-content");
  viscontent.id = "vismenu-content";

  settings.columnOrder.forEach(column => {
    if (typeof column !== "string")
      return;

    // Skip empty columns
    if (column === "checkboxes" && settings.checkboxes.length == 0)
      return;
    else if (column === "Quantity" && settings.bommode == "ungrouped")
      return;

    var label = document.createElement("label");
    label.classList.add("menu-label");

    var input = document.createElement("input");
    input.classList.add("visibility_checkbox");
    input.type = "checkbox";
    input.onchange = function (e) {
      setShowBOMColumn(column, e.target.checked)
    };
    input.checked = !(settings.hiddenColumns.includes(column));

    label.appendChild(input);
    if (column.length > 0)
      label.append(column[0].toUpperCase() + column.slice(1));

    viscontent.appendChild(label);
  });

  viscontent.childNodes[0].classList.add("menu-label-top");

  vismenu.appendChild(visbutton);
  if (settings.bommode != "netlist") {
    vismenu.appendChild(viscontent);
    th.appendChild(vismenu);
  }
  tr.appendChild(th);

  var checkboxCompareClosure = function (checkbox) {
    return (a, b) => {
      var stateA = getCheckboxState(checkbox, a);
      var stateB = getCheckboxState(checkbox, b);
      if (stateA > stateB) return -1;
      if (stateA < stateB) return 1;
      return 0;
    }
  }
  var stringFieldCompareClosure = function (fieldIndex) {
    return (a, b) => {
      var fa = pcbdata.bom.fields[a[0][1]][fieldIndex];
      var fb = pcbdata.bom.fields[b[0][1]][fieldIndex];
      if (fa != fb) return fa > fb ? 1 : -1;
      else return 0;
    }
  }
  var referenceRegex = /(?<prefix>[^0-9]+)(?<number>[0-9]+)/;
  var compareRefs = (a, b) => {
    var ra = referenceRegex.exec(a);
    var rb = referenceRegex.exec(b);
    if (ra === null || rb === null) {
      if (a != b) return a > b ? 1 : -1;
      return 0;
    } else {
      if (ra.groups.prefix != rb.groups.prefix) {
        return ra.groups.prefix > rb.groups.prefix ? 1 : -1;
      }
      if (ra.groups.number != rb.groups.number) {
        return parseInt(ra.groups.number) > parseInt(rb.groups.number) ? 1 : -1;
      }
      return 0;
    }
  }
  if (settings.bommode == "netlist") {
    tr.appendChild(createColumnHeader("Net name", "bom-netname", (a, b) => {
      if (a > b) return -1;
      if (a < b) return 1;
      return 0;
    }));
    tr.appendChild(createColumnHeader("Color", "bom-color", (a, b) => {
      return 0;
    }));
  } else {
    // Filter hidden columns
    var columns = settings.columnOrder.filter(e => !settings.hiddenColumns.includes(e));
    var valueIndex = config.fields.indexOf("Value");
    var footprintIndex = config.fields.indexOf("Footprint");
    columns.forEach((column) => {
      if (column === placeHolderColumn) {
        var n = 1;
        if (column === "checkboxes")
          n = settings.checkboxes.length;
        for (i = 0; i < n; i++) {
          td = placeHolderElements.shift();
          tr.appendChild(td);
        }
        return;
      } else if (column === "checkboxes") {
        for (var checkbox of settings.checkboxes) {
          th = createColumnHeader(
            checkbox, "bom-checkbox", checkboxCompareClosure(checkbox), true);
          tr.appendChild(th);
        }
      } else if (column === "References") {
        tr.appendChild(createColumnHeader("References", "references", (a, b) => {
          var i = 0;
          while (i < a.length && i < b.length) {
            if (a[i] != b[i]) return compareRefs(a[i][0], b[i][0]);
            i++;
          }
          return a.length - b.length;
        }));
      } else if (column === "Value") {
        tr.appendChild(createColumnHeader("Value", "value", (a, b) => {
          var ra = a[0][1], rb = b[0][1];
          return valueCompare(
            pcbdata.bom.parsedValues[ra], pcbdata.bom.parsedValues[rb],
            pcbdata.bom.fields[ra][valueIndex], pcbdata.bom.fields[rb][valueIndex]);
        }));
        return;
      } else if (column === "Footprint") {
        tr.appendChild(createColumnHeader(
          "Footprint", "footprint", stringFieldCompareClosure(footprintIndex)));
      } else if (column === "Quantity" && settings.bommode == "grouped") {
        tr.appendChild(createColumnHeader("Quantity", "quantity", (a, b) => {
          return a.length - b.length;
        }));
      } else {
        // Other fields
        var i = config.fields.indexOf(column);
        if (i < 0)
          return;
        tr.appendChild(createColumnHeader(
          column, `field${i + 1}`, stringFieldCompareClosure(i)));
      }
    });
  }
  bomhead.appendChild(tr);
}

function populateBomBody(placeholderColumn = null, placeHolderElements = null) {
  const urlRegex = /^(https?:\/\/[^\s\/$.?#][^\s]*|file:\/\/([a-zA-Z]:|\/)[^\x00]+)$/;
  while (bom.firstChild) {
    bom.removeChild(bom.firstChild);
  }
  highlightHandlers = [];
  footprintIndexToHandler = {};
  netsToHandler = {};
  currentHighlightedRowId = null;
  var first = true;
  var style = getComputedStyle(topmostdiv);
  var defaultNetColor = style.getPropertyValue('--track-color').trim();
  if (settings.bommode == "netlist") {
    bomtable = pcbdata.nets.slice();
  } else {
    switch (settings.canvaslayout) {
      case 'F':
        bomtable = pcbdata.bom.F.slice();
        break;
      case 'FB':
        bomtable = pcbdata.bom.both.slice();
        break;
      case 'B':
        bomtable = pcbdata.bom.B.slice();
        break;
    }
    if (settings.bommode == "ungrouped") {
      // expand bom table
      expandedTable = []
      for (var bomentry of bomtable) {
        for (var ref of bomentry) {
          expandedTable.push([ref]);
        }
      }
      bomtable = expandedTable;
    }
  }
  if (bomSortFunction) {
    bomtable = bomtable.sort(bomSortFunction);
  }
  for (var i in bomtable) {
    var bomentry = bomtable[i];
    if (filter && !entryMatches(bomentry)) {
      continue;
    }
    var references = null;
    var netname = null;
    var tr = document.createElement("TR");
    var td = document.createElement("TD");
    var rownum = +i + 1;
    tr.id = "bomrow" + rownum;
    td.textContent = rownum;
    tr.appendChild(td);
    if (settings.bommode == "netlist") {
      netname = bomentry;
      td = document.createElement("TD");
      td.innerHTML = highlightFilter(netname ? netname : "&lt;no net&gt;");
      tr.appendChild(td);
      var color = settings.netColors[netname] || defaultNetColor;
      td = document.createElement("TD");
      var colorBox = document.createElement("INPUT");
      colorBox.type = "color";
      colorBox.value = color;
      colorBox.onchange = netColorChangeHandler(netname);
      colorBox.onmouseup = netColorRightClick(netname);
      colorBox.oncontextmenu = (e) => e.preventDefault();
      td.appendChild(colorBox);
      td.classList.add("color-column");
      tr.appendChild(td);
    } else {
      if (reflookup) {
        references = findRefInEntry(bomentry);
        if (references.length == 0) {
          continue;
        }
      } else {
        references = bomentry;
      }
      // Filter hidden columns
      var columns = settings.columnOrder.filter(e => !settings.hiddenColumns.includes(e));
      columns.forEach((column) => {
        if (column === placeholderColumn) {
          var n = 1;
          if (column === "checkboxes")
            n = settings.checkboxes.length;
          for (i = 0; i < n; i++) {
            td = placeHolderElements.shift();
            tr.appendChild(td);
          }
          return;
        } else if (column === "checkboxes") {
          for (var checkbox of settings.checkboxes) {
            if (checkbox) {
              td = document.createElement("TD");
              var input = document.createElement("input");
              input.type = "checkbox";
              input.onchange = createCheckboxChangeHandler(checkbox, references, tr);
              setBomCheckboxState(checkbox, input, references);
              if (input.checked && settings.markWhenChecked == checkbox) {
                tr.classList.add("checked");
              }
              td.appendChild(input);
              tr.appendChild(td);
            }
          }
        } else if (column === "References") {
          td = document.createElement("TD");
          td.innerHTML = highlightFilter(references.map(r => r[0]).join(", "));
          tr.appendChild(td);
        } else if (column === "Quantity" && settings.bommode == "grouped") {
          // Quantity
          td = document.createElement("TD");
          td.textContent = references.length;
          tr.appendChild(td);
        } else {
          // All the other fields
          var field_index = config.fields.indexOf(column)
          if (field_index < 0)
            return;
          var valueSet = new Set();
          references.map(r => r[1]).forEach((id) => valueSet.add(pcbdata.bom.fields[id][field_index]));
          td = document.createElement("TD");
          var output = new Array();
          for (let item of valueSet) {
            const visible = highlightFilter(String(item));
            if (typeof item === 'string' && item.match(urlRegex)) {
              output.push(`<a href="${item}" target="_blank">${visible}</a>`);
            } else {
              output.push(visible);
            }
          }
          td.innerHTML = output.join(", ");
          tr.appendChild(td);
        }
      });
    }
    bom.appendChild(tr);
    var handler = createRowHighlightHandler(tr.id, references, netname);
    tr.onmousemove = handler;
    highlightHandlers.push({
      id: tr.id,
      handler: handler,
    });
    if (references !== null) {
      for (var refIndex of references.map(r => r[1])) {
        footprintIndexToHandler[refIndex] = handler;
      }
    }
    if (netname !== null) {
      netsToHandler[netname] = handler;
    }
    if ((filter || reflookup) && first) {
      handler();
      first = false;
    }
  }
  EventHandler.emitEvent(
    IBOM_EVENT_TYPES.BOM_BODY_CHANGE_EVENT, {
    filter: filter,
    reflookup: reflookup,
    checkboxes: settings.checkboxes,
    bommode: settings.bommode,
  });
}

function highlightPreviousRow() {
  if (!currentHighlightedRowId) {
    highlightHandlers[highlightHandlers.length - 1].handler();
  } else {
    if (highlightHandlers.length > 1 &&
      highlightHandlers[0].id == currentHighlightedRowId) {
      highlightHandlers[highlightHandlers.length - 1].handler();
    } else {
      for (var i = 0; i < highlightHandlers.length - 1; i++) {
        if (highlightHandlers[i + 1].id == currentHighlightedRowId) {
          highlightHandlers[i].handler();
          break;
        }
      }
    }
  }
  smoothScrollToRow(currentHighlightedRowId);
}

function highlightNextRow() {
  if (!currentHighlightedRowId) {
    highlightHandlers[0].handler();
  } else {
    if (highlightHandlers.length > 1 &&
      highlightHandlers[highlightHandlers.length - 1].id == currentHighlightedRowId) {
      highlightHandlers[0].handler();
    } else {
      for (var i = 1; i < highlightHandlers.length; i++) {
        if (highlightHandlers[i - 1].id == currentHighlightedRowId) {
          highlightHandlers[i].handler();
          break;
        }
      }
    }
  }
  smoothScrollToRow(currentHighlightedRowId);
}

function populateBomTable() {
  populateBomHeader();
  populateBomBody();
  setBomHandlers();
  resizableGrid(bomhead);
}

function footprintsClicked(footprintIndexes) {
  var lastClickedIndex = footprintIndexes.indexOf(lastClicked);
  for (var i = 1; i <= footprintIndexes.length; i++) {
    var refIndex = footprintIndexes[(lastClickedIndex + i) % footprintIndexes.length];
    if (refIndex in footprintIndexToHandler) {
      lastClicked = refIndex;
      footprintIndexToHandler[refIndex]();
      smoothScrollToRow(currentHighlightedRowId);
      break;
    }
  }
}

function netClicked(net) {
  if (net in netsToHandler) {
    netsToHandler[net]();
    smoothScrollToRow(currentHighlightedRowId);
  } else {
    clearHighlightedFootprints();
    highlightedNet = net;
    drawHighlights();
  }
}

function updateFilter(input) {
  filter = input.toLowerCase();
  populateBomTable();
}

function updateRefLookup(input) {
  reflookup = input.toLowerCase();
  populateBomTable();
}

function changeCanvasLayout(layout) {
  document.getElementById("fl-btn").classList.remove("depressed");
  document.getElementById("fb-btn").classList.remove("depressed");
  document.getElementById("bl-btn").classList.remove("depressed");
  switch (layout) {
    case 'F':
      document.getElementById("fl-btn").classList.add("depressed");
      if (settings.bomlayout != "bom-only") {
        canvassplit.collapse(1);
      }
      break;
    case 'B':
      document.getElementById("bl-btn").classList.add("depressed");
      if (settings.bomlayout != "bom-only") {
        canvassplit.collapse(0);
      }
      break;
    default:
      document.getElementById("fb-btn").classList.add("depressed");
      if (settings.bomlayout != "bom-only") {
        canvassplit.setSizes([50, 50]);
      }
  }
  settings.canvaslayout = layout;
  writeStorage("canvaslayout", layout);
  resizeAll();
  changeBomMode(settings.bommode);
}

function populateMetadata() {
  document.getElementById("title").innerHTML = pcbdata.metadata.title;
  document.getElementById("revision").innerHTML = "Rev: " + pcbdata.metadata.revision;
  document.getElementById("company").innerHTML = pcbdata.metadata.company;
  document.getElementById("filedate").innerHTML = pcbdata.metadata.date;
  if (pcbdata.metadata.title != "") {
    document.title = pcbdata.metadata.title + " BOM";
  }
  // Calculate board stats
  var fp_f = 0,
    fp_b = 0,
    pads_f = 0,
    pads_b = 0,
    pads_th = 0;
  for (var i = 0; i < pcbdata.footprints.length; i++) {
    if (pcbdata.bom.skipped.includes(i)) continue;
    var mod = pcbdata.footprints[i];
    if (mod.layer == "F") {
      fp_f++;
    } else {
      fp_b++;
    }
    for (var pad of mod.pads) {
      if (pad.type == "th") {
        pads_th++;
      } else {
        if (pad.layers.includes("F")) {
          pads_f++;
        }
        if (pad.layers.includes("B")) {
          pads_b++;
        }
      }
    }
  }
  document.getElementById("stats-components-front").innerHTML = fp_f;
  document.getElementById("stats-components-back").innerHTML = fp_b;
  document.getElementById("stats-components-total").innerHTML = fp_f + fp_b;
  document.getElementById("stats-groups-front").innerHTML = pcbdata.bom.F.length;
  document.getElementById("stats-groups-back").innerHTML = pcbdata.bom.B.length;
  document.getElementById("stats-groups-total").innerHTML = pcbdata.bom.both.length;
  document.getElementById("stats-smd-pads-front").innerHTML = pads_f;
  document.getElementById("stats-smd-pads-back").innerHTML = pads_b;
  document.getElementById("stats-smd-pads-total").innerHTML = pads_f + pads_b;
  document.getElementById("stats-th-pads").innerHTML = pads_th;
  // Update version string
  document.getElementById("github-link").innerHTML = "InteractiveHtmlBom&nbsp;" +
    /^v\d+\.\d+/.exec(pcbdata.ibom_version)[0];
}

function changeBomLayout(layout) {
  document.getElementById("bom-btn").classList.remove("depressed");
  document.getElementById("lr-btn").classList.remove("depressed");
  document.getElementById("tb-btn").classList.remove("depressed");
  switch (layout) {
    case 'bom-only':
      document.getElementById("bom-btn").classList.add("depressed");
      if (bomsplit) {
        bomsplit.destroy();
        bomsplit = null;
        canvassplit.destroy();
        canvassplit = null;
      }
      document.getElementById("frontcanvas").style.display = "none";
      document.getElementById("backcanvas").style.display = "none";
      document.getElementById("topmostdiv").style.height = "";
      document.getElementById("topmostdiv").style.display = "block";
      break;
    case 'top-bottom':
      document.getElementById("tb-btn").classList.add("depressed");
      document.getElementById("frontcanvas").style.display = "";
      document.getElementById("backcanvas").style.display = "";
      document.getElementById("topmostdiv").style.height = "100%";
      document.getElementById("topmostdiv").style.display = "flex";
      document.getElementById("bomdiv").classList.remove("split-horizontal");
      document.getElementById("canvasdiv").classList.remove("split-horizontal");
      document.getElementById("frontcanvas").classList.add("split-horizontal");
      document.getElementById("backcanvas").classList.add("split-horizontal");
      if (bomsplit) {
        bomsplit.destroy();
        bomsplit = null;
        canvassplit.destroy();
        canvassplit = null;
      }
      bomsplit = Split(['#bomdiv', '#canvasdiv'], {
        sizes: [50, 50],
        onDragEnd: resizeAll,
        direction: "vertical",
        gutterSize: 5
      });
      canvassplit = Split(['#frontcanvas', '#backcanvas'], {
        sizes: [50, 50],
        gutterSize: 5,
        onDragEnd: resizeAll
      });
      break;
    case 'left-right':
      document.getElementById("lr-btn").classList.add("depressed");
      document.getElementById("frontcanvas").style.display = "";
      document.getElementById("backcanvas").style.display = "";
      document.getElementById("topmostdiv").style.height = "100%";
      document.getElementById("topmostdiv").style.display = "flex";
      document.getElementById("bomdiv").classList.add("split-horizontal");
      document.getElementById("canvasdiv").classList.add("split-horizontal");
      document.getElementById("frontcanvas").classList.remove("split-horizontal");
      document.getElementById("backcanvas").classList.remove("split-horizontal");
      if (bomsplit) {
        bomsplit.destroy();
        bomsplit = null;
        canvassplit.destroy();
        canvassplit = null;
      }
      bomsplit = Split(['#bomdiv', '#canvasdiv'], {
        sizes: [50, 50],
        onDragEnd: resizeAll,
        gutterSize: 5
      });
      canvassplit = Split(['#frontcanvas', '#backcanvas'], {
        sizes: [50, 50],
        gutterSize: 5,
        direction: "vertical",
        onDragEnd: resizeAll
      });
  }
  settings.bomlayout = layout;
  writeStorage("bomlayout", layout);
  changeCanvasLayout(settings.canvaslayout);
}

function changeBomMode(mode) {
  document.getElementById("bom-grouped-btn").classList.remove("depressed");
  document.getElementById("bom-ungrouped-btn").classList.remove("depressed");
  document.getElementById("bom-netlist-btn").classList.remove("depressed");
  var chkbxs = document.getElementsByClassName("visibility_checkbox");

  switch (mode) {
    case 'grouped':
      document.getElementById("bom-grouped-btn").classList.add("depressed");
      for (var i = 0; i < chkbxs.length; i++) {
        chkbxs[i].disabled = false;
      }
      break;
    case 'ungrouped':
      document.getElementById("bom-ungrouped-btn").classList.add("depressed");
      for (var i = 0; i < chkbxs.length; i++) {
        chkbxs[i].disabled = false;
      }
      break;
    case 'netlist':
      document.getElementById("bom-netlist-btn").classList.add("depressed");
      for (var i = 0; i < chkbxs.length; i++) {
        chkbxs[i].disabled = true;
      }
  }

  writeStorage("bommode", mode);
  if (mode != settings.bommode) {
    settings.bommode = mode;
    bomSortFunction = null;
    currentSortColumn = null;
    currentSortOrder = null;
    clearHighlightedFootprints();
  }
  populateBomTable();
}

function focusFilterField() {
  focusInputField(document.getElementById("filter"));
}

function focusRefLookupField() {
  focusInputField(document.getElementById("reflookup"));
}

function toggleBomCheckbox(bomrowid, checkboxnum) {
  if (!bomrowid || checkboxnum > settings.checkboxes.length) {
    return;
  }
  var bomrow = document.getElementById(bomrowid);
  var checkbox = bomrow.childNodes[checkboxnum].childNodes[0];
  checkbox.checked = !checkbox.checked;
  checkbox.indeterminate = false;
  checkbox.onchange();
}

function checkBomCheckbox(bomrowid, checkboxname) {
  var checkboxnum = 0;
  while (checkboxnum < settings.checkboxes.length &&
    settings.checkboxes[checkboxnum].toLowerCase() != checkboxname.toLowerCase()) {
    checkboxnum++;
  }
  if (!bomrowid || checkboxnum >= settings.checkboxes.length) {
    return;
  }
  var bomrow = document.getElementById(bomrowid);
  var checkbox = bomrow.childNodes[checkboxnum + 1].childNodes[0];
  checkbox.checked = true;
  checkbox.indeterminate = false;
  checkbox.onchange();
}

function setBomCheckboxes(value) {
  writeStorage("bomCheckboxes", value);
  settings.checkboxes = value.split(",").map((e) => e.trim()).filter((e) => e);
  prepCheckboxes();
  populateMarkWhenCheckedOptions();
  setMarkWhenChecked(settings.markWhenChecked);
}

function setMarkWhenChecked(value) {
  writeStorage("markWhenChecked", value);
  settings.markWhenChecked = value;
  markedFootprints.clear();
  for (var ref of (value ? getStoredCheckboxRefs(value) : [])) {
    markedFootprints.add(ref);
  }
  populateBomTable();
  drawHighlights();
}

function prepCheckboxes() {
  var table = document.getElementById("checkbox-stats");
  while (table.childElementCount > 1) {
    table.removeChild(table.lastChild);
  }
  if (settings.checkboxes.length) {
    table.style.display = "";
  } else {
    table.style.display = "none";
  }
  for (var checkbox of settings.checkboxes) {
    var tr = document.createElement("TR");
    var td = document.createElement("TD");
    td.innerHTML = checkbox;
    tr.appendChild(td);
    td = document.createElement("TD");
    td.id = "checkbox-stats-" + checkbox;
    var progressbar = document.createElement("div");
    progressbar.classList.add("bar");
    td.appendChild(progressbar);
    var text = document.createElement("div");
    text.classList.add("text");
    td.appendChild(text);
    tr.appendChild(td);
    table.appendChild(tr);
    updateCheckboxStats(checkbox);
  }
}

function populateMarkWhenCheckedOptions() {
  var container = document.getElementById("markWhenCheckedContainer");

  if (settings.checkboxes.length == 0) {
    container.parentElement.style.display = "none";
    return;
  }

  container.innerHTML = '';
  container.parentElement.style.display = "inline-block";

  function createOption(name, displayName) {
    var id = "markWhenChecked-" + name;

    var div = document.createElement("div");
    div.classList.add("radio-container");

    var input = document.createElement("input");
    input.type = "radio";
    input.name = "markWhenChecked";
    input.value = name;
    input.id = id;
    input.onchange = () => setMarkWhenChecked(name);
    div.appendChild(input);

    // Preserve the selected element when the checkboxes change
    if (name == settings.markWhenChecked) {
      input.checked = true;
    }

    var label = document.createElement("label");
    label.innerHTML = displayName;
    label.htmlFor = id;
    div.appendChild(label);

    container.appendChild(div);
  }
  createOption("", "None");
  for (var checkbox of settings.checkboxes) {
    createOption(checkbox, checkbox);
  }
}

function updateCheckboxStats(checkbox) {
  var checked = getStoredCheckboxRefs(checkbox).size;
  var total = pcbdata.footprints.length - pcbdata.bom.skipped.length;
  var percent = checked * 100.0 / total;
  var td = document.getElementById("checkbox-stats-" + checkbox);
  td.firstChild.style.width = percent + "%";
  td.lastChild.innerHTML = checked + "/" + total + " (" + Math.round(percent) + "%)";
}

function constrain(number, min, max){
  return Math.min(Math.max(parseInt(number), min), max);
}

document.onkeydown = function (e) {
  switch (e.key) {
    case "n":
      if (document.activeElement.type == "text") {
        return;
      }
      if (currentHighlightedRowId !== null) {
        checkBomCheckbox(currentHighlightedRowId, "placed");
        highlightNextRow();
        e.preventDefault();
      }
      break;
    case "ArrowUp":
      highlightPreviousRow();
      e.preventDefault();
      break;
    case "ArrowDown":
      highlightNextRow();
      e.preventDefault();
      break;
    case "ArrowLeft":
    case "ArrowRight":
      if (document.activeElement.type != "text"){
        e.preventDefault();
        let boardRotationElement = document.getElementById("boardRotation")
        settings.boardRotation = parseInt(boardRotationElement.value);  // degrees / 5
        if (e.key == "ArrowLeft"){
            settings.boardRotation += 3;  // 15 degrees
        }
        else{
            settings.boardRotation -= 3;
        }
        settings.boardRotation = constrain(settings.boardRotation, boardRotationElement.min, boardRotationElement.max);
        boardRotationElement.value = settings.boardRotation
        setBoardRotation(settings.boardRotation);
      }
      break;
    default:
      break;
  }
  if (e.altKey) {
    switch (e.key) {
      case "f":
        focusFilterField();
        e.preventDefault();
        break;
      case "r":
        focusRefLookupField();
        e.preventDefault();
        break;
      case "z":
        changeBomLayout("bom-only");
        e.preventDefault();
        break;
      case "x":
        changeBomLayout("left-right");
        e.preventDefault();
        break;
      case "c":
        changeBomLayout("top-bottom");
        e.preventDefault();
        break;
      case "v":
        changeCanvasLayout("F");
        e.preventDefault();
        break;
      case "b":
        changeCanvasLayout("FB");
        e.preventDefault();
        break;
      case "n":
        changeCanvasLayout("B");
        e.preventDefault();
        break;
      default:
        break;
    }
    if (e.key >= '1' && e.key <= '9') {
      toggleBomCheckbox(currentHighlightedRowId, parseInt(e.key));
      e.preventDefault();
    }
  }
}

function hideNetlistButton() {
  document.getElementById("bom-ungrouped-btn").classList.remove("middle-button");
  document.getElementById("bom-ungrouped-btn").classList.add("right-most-button");
  document.getElementById("bom-netlist-btn").style.display = "none";
}

function topToggle() {
  var top = document.getElementById("top");
  var toptoggle = document.getElementById("toptoggle");
  if (top.style.display === "none") {
    top.style.display = "flex";
    toptoggle.classList.remove("flipped");
  } else {
    top.style.display = "none";
    toptoggle.classList.add("flipped");
  }
}

window.onload = function (e) {
  initUtils();
  initRender();
  initStorage();
  initDefaults();
  cleanGutters();
  populateMetadata();
  dbgdiv = document.getElementById("dbg");
  bom = document.getElementById("bombody");
  bomhead = document.getElementById("bomhead");
  filter = "";
  reflookup = "";
  if (!("nets" in pcbdata)) {
    hideNetlistButton();
  }
  initDone = true;
  setBomCheckboxes(document.getElementById("bomCheckboxes").value);
  // Triggers render
  changeBomLayout(settings.bomlayout);

  // Users may leave fullscreen without touching the checkbox. Uncheck.
  document.addEventListener('fullscreenchange', () => {
    if (!document.fullscreenElement)
      document.getElementById('fullscreenCheckbox').checked = false;
  });
}

window.onresize = resizeAll;
window.matchMedia("print").addListener(resizeAll);

///////////////////////////////////////////////

///////////////////////////////////////////////
// EventHandler.registerCallback(IBOM_EVENT_TYPES.BOM_BODY_CHANGE_EVENT, () => {
//     for(var tr of bom.childNodes) {
//         tr.onclick = tr.onmousemove;
//         tr.onmousemove = null;
//     };
// });

///////////////////////////////////////////////
  </script>
</head>

<body>

<div id="topmostdiv" class="topmostdiv">
  <div id="top">
    <div id="fileinfodiv">
      <table class="fileinfo">
        <tbody>
          <tr>
            <td id="title" class="title" style="width: 70%">
              Title
            </td>
            <td id="revision" class="title" style="width: 30%">
              Revision
            </td>
          </tr>
          <tr>
            <td id="company">
              Company
            </td>
            <td id="filedate">
              Date
            </td>
          </tr>
        </tbody>
      </table>
    </div>
    <div id="bomcontrols">
      <div class="hideonprint menu">
        <button class="menubtn"></button>
        <div class="menu-content">
          <label class="menu-label menu-label-top" style="width: calc(50% - 18px)">
            <input id="darkmodeCheckbox" type="checkbox" onchange="setDarkMode(this.checked)">
            Dark mode
          </label><!-- This comment eats space! All of it!
          --><label class="menu-label menu-label-top" style="width: calc(50% - 17px); border-left: 0;">
            <input id="fullscreenCheckbox" type="checkbox" onchange="setFullscreen(this.checked)">
            Full Screen
          </label>
          <label class="menu-label" style="width: calc(50% - 18px)">
            <input id="fabricationCheckbox" type="checkbox" checked onchange="fabricationVisible(this.checked)">
            Fab layer
          </label><!-- This comment eats space! All of it!
          --><label class="menu-label" style="width: calc(50% - 17px); border-left: 0;">
            <input id="silkscreenCheckbox" type="checkbox" checked onchange="silkscreenVisible(this.checked)">
            Silkscreen
          </label>
          <label class="menu-label" style="width: calc(50% - 18px)">
            <input id="referencesCheckbox" type="checkbox" checked onchange="referencesVisible(this.checked)">
            References
          </label><!-- This comment eats space! All of it!
          --><label class="menu-label" style="width: calc(50% - 17px); border-left: 0;">
            <input id="valuesCheckbox" type="checkbox" checked onchange="valuesVisible(this.checked)">
            Values
          </label>
          <div id="tracksAndZonesCheckboxes">
            <label class="menu-label" style="width: calc(50% - 18px)">
              <input id="tracksCheckbox" type="checkbox" checked onchange="tracksVisible(this.checked)">
              Tracks
            </label><!-- This comment eats space! All of it!
            --><label class="menu-label" style="width: calc(50% - 17px); border-left: 0;">
              <input id="zonesCheckbox" type="checkbox" checked onchange="zonesVisible(this.checked)">
              Zones
            </label>
          </div>
          <label class="menu-label" style="width: calc(50% - 18px)">
            <input id="padsCheckbox" type="checkbox" checked onchange="padsVisible(this.checked)">
            Pads
          </label><!-- This comment eats space! All of it!
          --><label class="menu-label" style="width: calc(50% - 17px); border-left: 0;">
            <input id="dnpOutlineCheckbox" type="checkbox" checked onchange="dnpOutline(this.checked)">
            DNP outlined
          </label>
          <label class="menu-label">
            <input id="dragCheckbox" type="checkbox" checked onchange="setRedrawOnDrag(this.checked)">
            Continuous redraw on drag
          </label>
          <label class="menu-label">
            Highlight first pin
            <form id="highlightpin1">
              <div class="flexbox">
                <label>
                  <input type="radio" name="highlightpin1" value="none" onchange="setHighlightPin1('none')">
                  None
                </label>
                <label>
                  <input type="radio" name="highlightpin1" value="all" onchange="setHighlightPin1('all')">
                  All
                </label>
                <label>
                  <input type="radio" name="highlightpin1" value="selected" onchange="setHighlightPin1('selected')">
                  Selected
                </label>
              </div>
            </form>
          </label>
          <label class="menu-label">
            <span>Board rotation</span>
            <span style="float: right"><span id="rotationDegree">0</span>&#176;</span>
            <input id="boardRotation" type="range" min="-36" max="36" value="0" class="slider" oninput="setBoardRotation(this.value)">
          </label>
          <label class="menu-label">
            <input id="offsetBackRotationCheckbox" type="checkbox" onchange="setOffsetBackRotation(this.checked)">
            Offset back rotation
          </label>
          <label class="menu-label">
            <div style="margin-left: 5px">Bom checkboxes</div>
            <input id="bomCheckboxes" class="menu-textbox" type=text
                   oninput="setBomCheckboxes(this.value)">
          </label>
          <label class="menu-label">
            <div style="margin-left: 5px">Mark when checked</div>
            <div id="markWhenCheckedContainer"></div>
          </label>
          <label class="menu-label">
            <span class="shameless-plug">
              <span>Created using</span>
              <a id="github-link" target="blank" href="https://github.com/openscopeproject/InteractiveHtmlBom">InteractiveHtmlBom</a>
              <a target="blank" title="Mouse and keyboard help" href="https://github.com/openscopeproject/InteractiveHtmlBom/wiki/Usage#bom-page-mouse-actions" style="text-decoration: none;"><label class="help-link">?</label></a>
            </span>
          </label>
        </div>
      </div>
      <div class="button-container hideonprint">
        <button id="fl-btn" class="left-most-button" onclick="changeCanvasLayout('F')"
                title="Front only">F
        </button>
        <button id="fb-btn" class="middle-button" onclick="changeCanvasLayout('FB')"
                title="Front and Back">FB
        </button>
        <button id="bl-btn" class="right-most-button" onclick="changeCanvasLayout('B')"
                title="Back only">B
        </button>
      </div>
      <div class="button-container hideonprint">
        <button id="bom-btn" class="left-most-button" onclick="changeBomLayout('bom-only')"
                title="BOM only"></button>
        <button id="lr-btn" class="middle-button" onclick="changeBomLayout('left-right')"
                title="BOM left, drawings right"></button>
        <button id="tb-btn" class="right-most-button" onclick="changeBomLayout('top-bottom')"
                title="BOM top, drawings bot"></button>
      </div>
      <div class="button-container hideonprint">
        <button id="bom-grouped-btn" class="left-most-button" onclick="changeBomMode('grouped')"
                title="Grouped BOM"></button>
        <button id="bom-ungrouped-btn" class="middle-button" onclick="changeBomMode('ungrouped')"
                title="Ungrouped BOM"></button>
        <button id="bom-netlist-btn" class="right-most-button" onclick="changeBomMode('netlist')"
                title="Netlist"></button>
      </div>
      <div class="hideonprint menu">
        <button class="statsbtn"></button>
        <div class="menu-content">
          <table class="stats">
            <tbody>
              <tr>
                <td width="40%">Board stats</td>
                <td>Front</td>
                <td>Back</td>
                <td>Total</td>
              </tr>
              <tr>
                <td>Components</td>
                <td id="stats-components-front">~</td>
                <td id="stats-components-back">~</td>
                <td id="stats-components-total">~</td>
              </tr>
              <tr>
                <td>Groups</td>
                <td id="stats-groups-front">~</td>
                <td id="stats-groups-back">~</td>
                <td id="stats-groups-total">~</td>
              </tr>
              <tr>
                <td>SMD pads</td>
                <td id="stats-smd-pads-front">~</td>
                <td id="stats-smd-pads-back">~</td>
                <td id="stats-smd-pads-total">~</td>
              </tr>
              <tr>
                <td>TH pads</td>
                <td colspan=3 id="stats-th-pads">~</td>
              </tr>
            </tbody>
          </table>
          <table class="stats">
            <col width="40%"/><col />
            <tbody id="checkbox-stats">
              <tr>
                <td colspan=2 style="border-top: 0">Checkboxes</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      <div class="hideonprint menu">
        <button class="iobtn"></button>
        <div class="menu-content">
          <div class="menu-label menu-label-top">
            <div style="margin-left: 5px;">Save board image</div>
            <div class="flexbox">
              <input id="render-save-width" class="menu-textbox" type="text" value="1000" placeholder="Width"
                  style="flex-grow: 1; width: 50px;" oninput="validateSaveImgDimension(this)">
              <span>X</span>
              <input id="render-save-height" class="menu-textbox" type="text" value="1000" placeholder="Height"
                  style="flex-grow: 1; width: 50px;" oninput="validateSaveImgDimension(this)">
            </div>
            <label>
              <input id="render-save-transparent" type="checkbox">
              Transparent background
            </label>
            <div class="flexbox">
              <button class="savebtn" onclick="saveImage('F')">Front</button>
              <button class="savebtn" onclick="saveImage('B')">Back</button>
            </div>
          </div>
          <div class="menu-label">
            <span style="margin-left: 5px;">Config and checkbox state</span>
            <div class="flexbox">
              <button class="savebtn" onclick="saveSettings()">Export</button>
              <button class="savebtn" onclick="loadSettings()">Import</button>
              <button class="savebtn" onclick="resetSettings()">Reset</button>
            </div>
          </div>
          <div class="menu-label">
            <span style="margin-left: 5px;">Save bom table as</span>
            <div class="flexbox">
              <button class="savebtn" onclick="saveBomTable('csv')">csv</button>
              <button class="savebtn" onclick="saveBomTable('txt')">txt</button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div id="topdivider">
    <div class="hideonprint">
      <div id="toptoggle" onclick="topToggle()"></div>
    </div>
  </div>
  <div id="bot" class="split" style="flex: 1 1">
    <div id="bomdiv" class="split split-horizontal">
      <div style="width: 100%">
        <input id="reflookup" class="textbox searchbox reflookup hideonprint" type="text" placeholder="Ref lookup"
               oninput="updateRefLookup(this.value)">
        <input id="filter" class="textbox searchbox filter hideonprint" type="text" placeholder="Filter"
               oninput="updateFilter(this.value)">
        <div class="button-container hideonprint" style="float: left; margin: 0;">
          <button id="copy" title="Copy bom table to clipboard"
               onclick="saveBomTable('clipboard')"></button>
        </div>
      </div>
      <div id="dbg"></div>
      <table class="bom" id="bomtable">
        <thead id="bomhead">
        </thead>
        <tbody id="bombody">
        </tbody>
      </table>
    </div>
    <div id="canvasdiv" class="split split-horizontal">
      <div id="frontcanvas" class="split" touch-action="none" style="overflow: hidden">
        <div style="position: relative; width: 100%; height: 100%;">
          <canvas id="F_bg" style="position: absolute; left: 0; top: 0; z-index: 0;"></canvas>
          <canvas id="F_fab" style="position: absolute; left: 0; top: 0; z-index: 1;"></canvas>
          <canvas id="F_slk" style="position: absolute; left: 0; top: 0; z-index: 2;"></canvas>
          <canvas id="F_hl" style="position: absolute; left: 0; top: 0; z-index: 3;"></canvas>
        </div>
      </div>
      <div id="backcanvas" class="split" touch-action="none" style="overflow: hidden">
        <div style="position: relative; width: 100%; height: 100%;">
          <canvas id="B_bg" style="position: absolute; left: 0; top: 0; z-index: 0;"></canvas>
          <canvas id="B_fab" style="position: absolute; left: 0; top: 0; z-index: 1;"></canvas>
          <canvas id="B_slk" style="position: absolute; left: 0; top: 0; z-index: 2;"></canvas>
          <canvas id="B_hl" style="position: absolute; left: 0; top: 0; z-index: 3;"></canvas>
        </div>
      </div>
    </div>
  </div>
</div>

</body>

</html>
